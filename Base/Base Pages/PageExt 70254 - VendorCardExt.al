pageextension 70254 VendorCardExt extends "Vendor Card"
{
    // version NAVW19.00.00.50458,NAVIN9.00.00.50458,QC1.0,MSPT1.0

    layout
    {

        //Unsupported feature: Change Name on "Control 1900000001". Please convert manually.


        //Unsupported feature: Change Name on "Control 1". Please convert manually.


        //Unsupported feature: Change Name on "Control 2". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 2". Please convert manually.

        modify("Control 4")
        {

            //Unsupported feature: Change Name on "Control 4". Please convert manually.

            CaptionML = ENU = 'Name *', ENN = 'Name';

            //Unsupported feature: Change ImplicitType on "Control 4". Please convert manually.

        }
        modify("Control 79")
        {

            //Unsupported feature: Change Name on "Control 79". Please convert manually.

            CaptionML = ENN = 'Post Code';

            //Unsupported feature: Change ImplicitType on "Control 79". Please convert manually.

        }

        //Unsupported feature: Change Name on "Control 81". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 81". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500038". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500038". Please convert manually.


        //Unsupported feature: Change Name on "Control 12". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 12". Please convert manually.


        //Unsupported feature: Change Name on "Control 10". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 10". Please convert manually.


        //Unsupported feature: Change Name on "Control 18". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 18". Please convert manually.


        //Unsupported feature: Change Name on "Control 92". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 92". Please convert manually.


        //Unsupported feature: Change Name on "Control 22". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 22". Please convert manually.


        //Unsupported feature: Change Name on "Control 55". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 55". Please convert manually.


        //Unsupported feature: Change Name on "Control 24". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 24". Please convert manually.


        //Unsupported feature: Change Name on "Control 200". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 200". Please convert manually.


        //Unsupported feature: Change Name on "Control 26". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 26". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500045". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500045". Please convert manually.


        //Unsupported feature: Change Name on "Control 1902768601". Please convert manually.


        //Unsupported feature: Change Name on "Control 45". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 45". Please convert manually.

        modify("Control 48")
        {

            //Unsupported feature: Change Name on "Control 48". Please convert manually.

            CaptionML = ENU = 'E-Mail *', ENN = 'E-Mail';

            //Unsupported feature: Change ImplicitType on "Control 48". Please convert manually.

        }

        //Unsupported feature: Change Name on "Control 86". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 86". Please convert manually.


        //Unsupported feature: Change Name on "Control 125". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 125". Please convert manually.


        //Unsupported feature: Change Name on "Control 1905885101". Please convert manually.


        //Unsupported feature: Change Name on "Control 30". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 30". Please convert manually.


        //Unsupported feature: Change Name on "Control 23". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 23". Please convert manually.


        //Unsupported feature: Change Name on "Control 25". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 25". Please convert manually.

        modify("Control 1500042")
        {

            //Unsupported feature: Change Name on "Control 1500042". Please convert manually.

            CaptionML = ENU = 'Tax Liable *', ENN = 'Tax Liable';

            //Unsupported feature: Change ImplicitType on "Control 1500042". Please convert manually.

        }
        modify("Control 60")
        {

            //Unsupported feature: Change Name on "Control 60". Please convert manually.

            CaptionML = ENU = 'Gen. Bus. Posting Group *', ENN = 'Gen. Bus. Posting Group';

            //Unsupported feature: Change ImplicitType on "Control 60". Please convert manually.

        }
        modify("Control 90")
        {

            //Unsupported feature: Change Name on "Control 90". Please convert manually.

            CaptionML = ENU = 'VAT Bus. Posting Group *', ENN = 'VAT Bus. Posting Group';

            //Unsupported feature: Change ImplicitType on "Control 90". Please convert manually.

        }
        modify("Control 1500040")
        {

            //Unsupported feature: Change Name on "Control 1500040". Please convert manually.

            CaptionML = ENU = 'Excise Bus. Posting Group *', ENN = 'Excise Bus. Posting Group';

            //Unsupported feature: Change ImplicitType on "Control 1500040". Please convert manually.

        }
        modify("Control 32")
        {

            //Unsupported feature: Change Name on "Control 32". Please convert manually.

            CaptionML = ENU = 'Vendor Posting Group *', ENN = 'Vendor Posting Group';

            //Unsupported feature: Change ImplicitType on "Control 32". Please convert manually.

        }

        //Unsupported feature: Change NotBlank on "Control 34". Please convert manually.


        //Unsupported feature: Change Name on "Control 34". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 34". Please convert manually.


        //Unsupported feature: Change Name on "Control 94". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 94". Please convert manually.


        //Unsupported feature: Change Name on "Control 127". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 127". Please convert manually.


        //Unsupported feature: Change Name on "Control 1901677601". Please convert manually.


        //Unsupported feature: Change Name on "Control 36". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 36". Please convert manually.


        //Unsupported feature: Change Name on "Control 15". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 15". Please convert manually.

        modify("Control 38")
        {

            //Unsupported feature: Change Name on "Control 38". Please convert manually.

            CaptionML = ENU = 'Payment Terms Code *', ENN = 'Payment Terms Code';

            //Unsupported feature: Change ImplicitType on "Control 38". Please convert manually.

        }
        modify("Control 40")
        {

            //Unsupported feature: Change Name on "Control 40". Please convert manually.

            CaptionML = ENU = 'Payment Method Code *', ENN = 'Payment Method Code';

            //Unsupported feature: Change ImplicitType on "Control 40". Please convert manually.

        }

        //Unsupported feature: Change Name on "Control 42". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 42". Please convert manually.


        //Unsupported feature: Change Name on "Control 3". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 3". Please convert manually.


        //Unsupported feature: Change Name on "Control 50". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 50". Please convert manually.


        //Unsupported feature: Change Name on "Control 119". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 119". Please convert manually.


        //Unsupported feature: Change Name on "Control 13". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 13". Please convert manually.


        //Unsupported feature: Change Name on "Control 9". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 9". Please convert manually.


        //Unsupported feature: Change Name on "Control 1901075901". Please convert manually.

        modify("Control 100")
        {

            //Unsupported feature: Change Name on "Control 100". Please convert manually.

            CaptionML = ENU = 'Location Code *', ENN = 'Location Code';

            //Unsupported feature: Change ImplicitType on "Control 100". Please convert manually.

        }

        //Unsupported feature: Change Name on "Control 28". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 28". Please convert manually.


        //Unsupported feature: Change Name on "Control 96". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 96". Please convert manually.


        //Unsupported feature: Change DrillDown on "Control 112". Please convert manually.


        //Unsupported feature: Change Name on "Control 112". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 112". Please convert manually.


        //Unsupported feature: Change Name on "Control 1907468901". Please convert manually.

        modify("Control 52")
        {

            //Unsupported feature: Change Name on "Control 52". Please convert manually.

            CaptionML = ENU = 'Currency Code *', ENN = 'Currency Code';

            //Unsupported feature: Change ImplicitType on "Control 52". Please convert manually.

        }

        //Unsupported feature: Change Name on "Control 56". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 56". Please convert manually.


        //Unsupported feature: Change Name on "Control 1902697801". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500035". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500023". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500023". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500022". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500022". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500036". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500021". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500021". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500020". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500020". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500019". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500019". Please convert manually.

        modify("Control 1500024")
        {

            //Unsupported feature: Change Name on "Control 1500024". Please convert manually.

            OptionCaptionML = ENU = ' ,Manufacturer,First Stage Dealer,Second Stage Dealer,Importer,Trader,Authorized distributor,Online Supplier,Survice Provider', ENN = ' ,Manufacturer,First Stage Dealer,Second Stage Dealer,Importer,Trader,Authorized distributor,Online Supplier,Survice Provider';

            //Unsupported feature: Change ImplicitType on "Control 1500024". Please convert manually.

        }

        //Unsupported feature: Change Name on "Control 1500037". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500025". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500025". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500026". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500026". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500014". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500000". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500000". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500001". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500001". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500002". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500002". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500015". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500044". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500044". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500003". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500003". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500018". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500004". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500004". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500006". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500006". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500016". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500016". Please convert manually.


        //Unsupported feature: Change Level on "Control 1500005". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500005". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500005". Please convert manually.


        //Unsupported feature: Change Level on "Control 1500011". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500011". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500011". Please convert manually.


        //Unsupported feature: Change Name on "Control 1900000007". Please convert manually.


        //Unsupported feature: Change SubPageLink on "Control 17". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 17". Please convert manually.


        //Unsupported feature: Change Name on "Control 17". Please convert manually.


        //Unsupported feature: Change SubPageLink on "Control 19". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 19". Please convert manually.


        //Unsupported feature: Change Name on "Control 19". Please convert manually.


        //Unsupported feature: Change SubPageLink on "Control 1904651607". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 1904651607". Please convert manually.


        //Unsupported feature: Change Name on "Control 1904651607". Please convert manually.


        //Unsupported feature: Change SubPageLink on "Control 1903435607". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 1903435607". Please convert manually.


        //Unsupported feature: Change Name on "Control 1903435607". Please convert manually.


        //Unsupported feature: Change SubPageLink on "Control 1906949207". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 1906949207". Please convert manually.


        //Unsupported feature: Change Name on "Control 1906949207". Please convert manually.


        //Unsupported feature: Change PagePartID on "WorkflowStatus(Control 41)". Please convert manually.


        //Unsupported feature: Change ShowFilter on "WorkflowStatus(Control 41)". Please convert manually.


        //Unsupported feature: Change Name on "Control 1900383207". Please convert manually.


        //Unsupported feature: Change Name on "Control 1905767507". Please convert manually.

        modify("Control 6")
        {
            Visible = false;
        }
        modify("Control 8")
        {
            Visible = false;
        }
        modify("Control 114")
        {
            Visible = false;
        }
        modify("Control 16")
        {
            Visible = false;
        }

        //Unsupported feature: CodeModification on "Control 92.OnDrillDown". Please convert manually.

        //trigger OnDrillDown();
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
        /*
        DtldVendLedgEntry.SETRANGE("Vendor No.","No.");
        COPYFILTER("Global Dimension 1 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 1");
        COPYFILTER("Global Dimension 2 Filter",DtldVendLedgEntry."Initial Entry Global Dim. 2");
        COPYFILTER("Currency Filter",DtldVendLedgEntry."Currency Code");
        VendLedgEntry.DrillDownOnEntries(DtldVendLedgEntry);
        */
        //end;
        //>>>> MODIFIED CODE:
        //begin
        /*
        //Rev01
        #1..5
        //Rev01
        */
        //end;
        modify("Phone No.2")
        {
            Visible = false;
        }


        //Unsupported feature: CodeInsertion on ""E-Mail"(Control 48)". Please convert manually.

        //trigger OnValidate();
        //Parameters and return type have not been exported.
        //begin
        /*
        CheckValidEmailAddresses("E-Mail");
        */
        //end;
        modify("Control 1500008")
        {
            Visible = false;
        }
        modify("Control 1500009")
        {
            Visible = false;
        }
        modify("Control 1500007")
        {
            Visible = false;
        }
        modify("Control 1500010")
        {
            Visible = false;
        }
        addafter("Control 4")
        {
            field("Name 2"; "Name 2")
            {
            }
            field(Address; Address)
            {
            }
            field("Address 2"; "Address 2")
            {
            }
            field("Address 3"; "Address 3")
            {
            }
        }
        addafter("Control 1500038")
        {
            field("Primary Contact No."; "Primary Contact No.")
            {
            }
            field(Contact; Contact)
            {
            }
            field("Tally Reference"; "Tally Reference")
            {
            }
            field("User Id"; "User Id")
            {
            }
            field("Personal Account"; "Personal Account")
            {
            }
            field("C-Form"; "C-Form")
            {
                Caption = 'C-Form *';
            }
            field("Updated in Cashflow"; "Updated in Cashflow")
            {
                Caption = 'Updated in Cashflow *';

                trigger OnValidate();
                begin
                    charvar := 39;
                    name2 := '';
                    name1 := '';
                    IF "Updated in Cashflow" THEN BEGIN
                        TESTFIELD(Name);
                        TESTFIELD(City);
                        IF category = category::Primary THEN
                            cat := 1
                        ELSE
                            IF category = category::Secondary THEN
                                cat := 2
                            ELSE
                                IF category = category::Lower THEN
                                    cat := 3;
                        IF cat = 0 THEN
                            ERROR('Select category for Vendor');
                        IF "Purchaser Code" = '' THEN
                            ERROR('Please select Purchaser Code!');     //added by pranavi on 18-jun-2016
                                                                        //CASHFLOWCONNECTION.ExecInOracle('Delete  From MRP_ERP_VENDOR where VENDOR_ID='''+"No."+'''');

                        IF NOT (("Vendor Posting Group" = 'FOREIGN') OR ("GST Vendor Type" = "GST Vendor Type"::Import)) THEN
                            TESTFIELD("State Code");
                        IF "GST Vendor Type" = "GST Vendor Type"::" " THEN
                            ERROR('Please Specify GST Vendor Type') //added by sujani  on 19-Dec-18
                        ELSE BEGIN
                            IF "GST Vendor Type" = "GST Vendor Type"::Registered THEN
                                IF "GST Registration No." = '' THEN
                                    ERROR('Please Specify GST Registration No');
                        END;

                        IF "Payment Method Code" = 'CHQ' THEN
                            Payment_Mode := 'CHEQUE'
                        ELSE
                            Payment_Mode := "Payment Method Code";
                        //Added By Pranavi
                        IF Name <> '' THEN BEGIN
                            position1 := STRPOS(Name, FORMAT(charvar));
                            IF position1 > 0 THEN
                                name1 := DELSTR(Name, position1, 1)
                            ELSE
                                name1 := Name;
                        END;
                        IF "Name 2" <> '' THEN BEGIN
                            position2 := STRPOS("Name 2", FORMAT(charvar));
                            IF position2 > 0 THEN
                                name2 := DELSTR("Name 2", position2, 1)
                            ELSE
                                name2 := "Name 2";
                        END;
                        //End By Pranavi
                        //Added by Pranavi on 24-Dec-2015
                        /*IF ("RTGS Code" <> '') AND ("Payment Method Code" <> 'RTGS') THEN
                            ERROR('Payment Method Code must be "RTGS"!');*/ // commented by vijaya on 24-01-2018 bcoz Payment method code need not to be RTGS even if vendor had RTGS Code
                        IF "Payment Method Code" = 'RTGS' THEN BEGIN
                            IF "RTGS Code" = '' THEN
                                ERROR('Please enter RTGS CODE in Payments Tab as payment method is RTGS!');
                            IF "Our Account No." = '' THEN
                                ERROR('Please enter Our Account No. in Payments Tab as payment method is RTGS!');
                            IF "Name of Bank" = '' THEN
                                ERROR('Please enter Name of Bank in Payments Tab as payment method is RTGS!');
                            IF "Branch Name" = '' THEN
                                ERROR('Please enter Branch Name in Payments Tab as payment method is RTGS!');
                            IF "E-Mail" = '' THEN
                                ERROR('Please enter E-Mail Address!');
                            IF "Mobile No." = '' THEN
                                ERROR('Please enter Mobile No.!');
                            MobileNo := "Mobile No.";
                        END ELSE
                            MobileNo := "Phone No.";
                        //End by Pranavi
                        // Added by Pranavi on 24-feb-2016 for TIN number validation
                        /* IF USERID <> 'EFFTRONICS\PRANAVI' THEN
                         IF ("T.I.N. No." = '') AND ("T.I.N Status" IN["T.I.N Status"::" ","T.I.N Status"::TINAPPLIED]) THEN
                           ERROR('Please enter T.I.N Number in Tax Information Tab!');*/
                        // End by Pranavi
                        CASHFLOWCONNECTION.ExecInOracle('Delete  From MRP_ERP_VENDOR where VENDOR_ID=''' + "No." + '''');
                        CASHFLOWCONNECTION.ExecInOracle(
                               'INSERT INTO MRP_ERP_VENDOR (VENDOR_ID,NAME,CITY,DETAIL,ADDRESSLINE1,ADDRESSLINE2,STATE,CUST_CATEGORY,BANKNAME,' +
                               'BRANCHNAME,ACCOUNTNO, RTGSCODE,PAY_MODE,EMAIL_ID,CONTACT_PERSON,CONTACT_PHONE)  VALUES ' +
                                          '(''' + "No." + ''',''' + CommaRemoval(name1 + ' ' + name2) + ''',''' +
                                          CommaRemoval(City) + ''',''' + CommaRemoval(name1) + ''',''' +
                                          'null' + ''',''' + 'null' + ''',''' + CommaRemoval("State Code") + ''',''' + FORMAT(cat) + ''',''' +
                                          "Name of Bank" + ''',''' + "Branch Name" + ''',''' + "Our Account No." + ''',''' + "RTGS Code" + ''',''' +
                                          Payment_Mode + ''',''' + "E-Mail" + ''',''' + Contact + ''',''' + MobileNo + ''')');
                    END ELSE BEGIN
                        //CASHFLOWCONNECTION.ExecInOracle('Delete  From MRP_ERP_VENDOR where VENDOR_ID='''+"No."+'''');
                    END;

                end;
            }
            field("Vendor Balance Verified"; "Vendor Balance Verified")
            {
                Caption = 'Vendor Balance Verified';
            }
            field("Prod Vendor Balance"; "Prod Vendor Balance")
            {

                trigger OnDrillDown();
                begin
                    DrillDownProdVendorBalance;
                end;
            }
        }
        addafter("Control 92")
        {
            field("CS Vendor Balance"; "CS Vendor Balance")
            {

                trigger OnDrillDown();
                begin
                    DrillDownCSVendorBalance;
                end;
            }
            field("RD Vendor Balance"; "RD Vendor Balance")
            {

                trigger OnDrillDown();
                begin
                    DrillDownRDVendorBalance;
                end;
            }
            field("Admin Vendor Balance"; "Admin Vendor Balance")
            {
            }
        }
        addafter("Control 1500045")
        {
            field("TDS Alert"; "TDS Alert")
            {
            }
            field("Vendor Category"; "Vendor Category")
            {
            }
            field("Vendor Status"; "Vendor Status")
            {
            }
            field("Minimum Order Value"; "Minimum Order Value")
            {
                Editable = MINIMUMORDERVALCHECK;
            }
            field("Online Vendor"; "Online Vendor")
            {
            }
            group("Approvals Info")
            {
                Caption = 'Approvals Info';
                field("Maanager Approved"; "Maanager Approved")
                {
                    Caption = '" Approved"';
                    Editable = Manager_Appr;

                    trigger OnValidate();
                    begin
                        // added by Vishnu Priya on 12-11-2020
                        IF "Maanager Approved" = TRUE THEN BEGIN
                            Rec."Approved By" := USERID;
                            Rec.MODIFY;
                        END
                        ELSE BEGIN
                            Rec."Approved By" := '';
                            Rec.MODIFY;
                        END;

                    end;
                }
                field("Approved By"; "Approved By")
                {
                    Editable = false;
                }
                field(Created_Date_time; Created_Date_time)
                {
                    Caption = 'Created Date Time';
                    Editable = false;
                }
            }
        }
        addfirst("Control 1902768601")
        {
            field("<Phone No. 2>"; "Phone No.")
            {
                Importance = Promoted;
            }
            field("Phone No2"; "Phone No2")
            {
            }
            field("Phone No3"; "Phone No3")
            {
            }
            field("Phone No4"; "Phone No4")
            {
            }
            field("Mobile No."; "Mobile No.")
            {
            }
        }
        addafter("Control 125")
        {
            field(Remarks; Remarks)
            {
            }
            field("Transportation Days"; "Transportation Days")
            {
            }
        }
        addafter("Control 1500042")
        {
            field("MSPT Code"; "MSPT Code")
            {
            }
            field("Consider Vendor Invoice Date"; "Consider Vendor Invoice Date")
            {
            }
            field("Standard Packing %"; "Standard Packing %")
            {
            }
            field("Standard Insurnece %"; "Standard Insurnece %")
            {
            }
        }
        addafter("Control 127")
        {
            field("Tax Area Code"; "Tax Area Code")
            {
                CaptionML = ENU = 'Tax Area Code *',
                            ENN = 'Tax Area Code';
            }
            field(Structure; Structure)
            {
            }
        }
        addafter("Control 50")
        {
            field("Name of Bank"; "Name of Bank")
            {
            }
            field("Branch Name"; "Branch Name")
            {
            }
            field("RTGS Code"; "RTGS Code")
            {
            }
            field(category; category)
            {
            }
        }
        addfirst("Control 1500037")
        {
            field("T.I.N Status"; "T.I.N Status")
            {
            }
        }
        addafter("Control 1500026")
        {
            field("TAN Number"; "TAN Number")
            {
            }
        }
        addafter("Control 1500018")
        {
            group(GST)
            {
                CaptionML = ENU = 'GST',
                            ENN = 'GST';
                field("GST Registration No."; "GST Registration No.")
                {
                }
                field("GST Vendor Type"; "GST Vendor Type")
                {
                }
                field("Associated Enterprises"; "Associated Enterprises")
                {
                }
                field("GST Verification"; "GST Verification")
                {
                }
            }
            group(Quality)
            {
                Caption = 'Quality';
                field("Rework Location"; "Rework Location")
                {
                }
            }
        }
    }
    actions
    {

        //Unsupported feature: Change Name on "Action 1900000003". Please convert manually.


        //Unsupported feature: Change Name on "Action 64". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 184". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 184". Please convert manually.


        //Unsupported feature: Change Name on "Action 184". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 87". Please convert manually.


        //Unsupported feature: Change Name on "Action 87". Please convert manually.


        //Unsupported feature: Change AccessByPermission on "Action 14". Please convert manually.


        //Unsupported feature: Change Name on "Action 14". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 54". Please convert manually.


        //Unsupported feature: Change Name on "Action 54". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 68". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 68". Please convert manually.


        //Unsupported feature: Change Name on "Action 68". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 84". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 84". Please convert manually.


        //Unsupported feature: Change Name on "Action 84". Please convert manually.


        //Unsupported feature: Change Name on "Action 102". Please convert manually.


        //Unsupported feature: Change Name on "Action 11". Please convert manually.


        //Unsupported feature: Change Name on "Action 83". Please convert manually.


        //Unsupported feature: Change Name on "Action 108". Please convert manually.


        //Unsupported feature: Change Name on "Action 71". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 118". Please convert manually.


        //Unsupported feature: Change Name on "Action 118". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 73". Please convert manually.


        //Unsupported feature: Change Name on "Action 73". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 72". Please convert manually.


        //Unsupported feature: Change Name on "Action 72". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 116". Please convert manually.


        //Unsupported feature: Change Name on "Action 116". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 129". Please convert manually.


        //Unsupported feature: Change Name on "Action 129". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 123". Please convert manually.


        //Unsupported feature: Change Name on "Action 123". Please convert manually.


        //Unsupported feature: Change Name on "Action 117". Please convert manually.


        //Unsupported feature: Change Name on "Action 5". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 74". Please convert manually.


        //Unsupported feature: Change Name on "Action 74". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 75". Please convert manually.


        //Unsupported feature: Change Name on "Action 75". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 99". Please convert manually.


        //Unsupported feature: Change Name on "Action 99". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 21". Please convert manually.


        //Unsupported feature: Change Name on "Action 21". Please convert manually.


        //Unsupported feature: Change Name on "Action 7". Please convert manually.

        modify("Action 70")
        {

            //Unsupported feature: Change RunObject on "Action 70". Please convert manually.

            Promoted = false;

            //Unsupported feature: Change Name on "Action 70". Please convert manually.

        }
        modify("Action 66")
        {

            //Unsupported feature: Change RunObject on "Action 66". Please convert manually.


            //Unsupported feature: Change RunPageLink on "Action 66". Please convert manually.

            Promoted = true;

            //Unsupported feature: Change Name on "Action 66". Please convert manually.

        }

        //Unsupported feature: Change ImplicitType on "Action 69". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 69". Please convert manually.


        //Unsupported feature: Change Name on "Action 69". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 67". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 67". Please convert manually.


        //Unsupported feature: Change Name on "Action 67". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 20". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 20". Please convert manually.


        //Unsupported feature: Change Name on "Action 20". Please convert manually.


        //Unsupported feature: Change Name on "Action 6500". Please convert manually.


        //Unsupported feature: Change Name on "Action 1900000005". Please convert manually.

        modify("Action 1903213705")
        {

            //Unsupported feature: Change RunObject on "Action 1903213705". Please convert manually.

            Promoted = false;

            //Unsupported feature: Change Name on "Action 1903213705". Please convert manually.

        }
        modify("Action 1901469405")
        {

            //Unsupported feature: Change RunObject on "Action 1901469405". Please convert manually.

            Promoted = false;

            //Unsupported feature: Change Name on "Action 1901469405". Please convert manually.

        }
        modify("Action 1907709505")
        {

            //Unsupported feature: Change RunObject on "Action 1907709505". Please convert manually.

            Promoted = true;

            //Unsupported feature: Change Name on "Action 1907709505". Please convert manually.

        }
        modify("Action 1907375405")
        {

            //Unsupported feature: Change RunObject on "Action 1907375405". Please convert manually.

            Promoted = true;

            //Unsupported feature: Change Name on "Action 1907375405". Please convert manually.

        }
        modify("Action 1905024805")
        {

            //Unsupported feature: Change RunObject on "Action 1905024805". Please convert manually.

            Promoted = false;

            //Unsupported feature: Change Name on "Action 1905024805". Please convert manually.

        }
        modify("Action 1904749705")
        {

            //Unsupported feature: Change RunObject on "Action 1904749705". Please convert manually.

            Promoted = false;

            //Unsupported feature: Change Name on "Action 1904749705". Please convert manually.

        }

        //Unsupported feature: Change Name on "Action 1900000004". Please convert manually.


        //Unsupported feature: Change Name on "Action 39". Please convert manually.

        modify(Approve)
        {
            Promoted = true;
            PromotedIsBig = true;
        }
        modify(Reject)
        {
            Promoted = true;
            PromotedIsBig = true;
        }
        modify(Delegate)
        {
            Promoted = true;
        }

        //Unsupported feature: Change Name on "Action 31". Please convert manually.

        modify(SendApprovalRequest)
        {
            Promoted = true;
        }
        modify(CancelApprovalRequest)
        {
            Promoted = true;
        }

        //Unsupported feature: Change Name on "Action 130". Please convert manually.

        modify(ApplyTemplate)
        {

            //Unsupported feature: Change Ellipsis on "ApplyTemplate(Action 131)". Please convert manually.

            Promoted = true;
        }
        modify("Action 1902327104")
        {

            //Unsupported feature: Change RunObject on "Action 1902327104". Please convert manually.

            Promoted = true;

            //Unsupported feature: Change Name on "Action 1902327104". Please convert manually.

        }
        modify("Action 1906371704")
        {

            //Unsupported feature: Change RunObject on "Action 1906371704". Please convert manually.

            Promoted = true;

            //Unsupported feature: Change Name on "Action 1906371704". Please convert manually.

        }

        //Unsupported feature: Change Name on "Action 1900000006". Please convert manually.

        modify("Action 1905916106")
        {

            //Unsupported feature: Change RunObject on "Action 1905916106". Please convert manually.

            Promoted = false;

            //Unsupported feature: Change Name on "Action 1905916106". Please convert manually.

        }
        modify("Action 1904504206")
        {

            //Unsupported feature: Change RunObject on "Action 1904504206". Please convert manually.

            Promoted = false;

            //Unsupported feature: Change Name on "Action 1904504206". Please convert manually.

        }
        addfirst("Action 64")
        {
            group("Purchase &History")
            {
                Caption = 'Purchase &History';
            }
        }
        addafter("Action 68")
        {
            action("&MSPT Payables")
            {
                Caption = '&MSPT Payables';
                RunObject = Page "MSPT Vendor Purchases";
                RunPageLink = No.=FIELD(No.),Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
            }
        }
        addafter("Action 21")
        {
            action("Order Lines")
            {
                Caption = 'Order Lines';

                trigger OnAction();
                begin
                    PLGrec.RESET;
                    PLGrec.SETFILTER(PLGrec."Buy-from Vendor No.","No.");
                    PLGrec.SETFILTER(PLGrec."Order Date",'>%1',DMY2DATE(1,4,2008));
                    PLGrec.SETFILTER(PLGrec.Quantity,'>%1',0);
                    PAGE.RUNMODAL(56,PLGrec);
                end;
            }
        }
        addafter("Action 1904504206")
        {
            action("GST Details")
            {
                Promoted = true;
                PromotedCategory = Process;

                trigger OnAction();
                begin
                    HYPERLINK('http://app.efftronics.org:8567/GSTRegInternal/GSTRegistrationDetails.aspx?V_C_Num='+"No.");
                end;
            }
            action("Send GST Mail")
            {
                Promoted = true;
                PromotedCategory = Process;

                trigger OnAction();
                begin
                    GSTMails;
                end;
            }
            action(Attachments)
            {
                Caption = 'Attachments';
                Image = Attachments;
                Promoted = true;
                PromotedCategory = Process;
                RunObject = Page "ESPL Attachments";
                                RunPageLink = Table ID=CONST(23),Document No.=FIELD(No.);
            }
        }
    }


    //Unsupported feature: PropertyModification on "VendorReportSelections(Action 225).OnAction.CustomReportSelection(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //VendorReportSelections : 9657;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //VendorReportSelections : "Custom Report Selection";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 6500.OnAction.ItemTrackingDocMgt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 6500.OnAction.ItemTrackingDocMgt : 6503;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 6500.OnAction.ItemTrackingDocMgt : "Item Tracking Doc. Management";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Approve(Action 37).OnAction.ApprovalsMgmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Approve : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Approve : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Reject(Action 35).OnAction.ApprovalsMgmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Reject : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Reject : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Delegate(Action 33).OnAction.ApprovalsMgmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Delegate : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Delegate : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "SendApprovalRequest(Action 29).OnAction.ApprovalsMgmt(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //SendApprovalRequest : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //SendApprovalRequest : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "CancelApprovalRequest(Action 27).OnAction.ApprovalsMgmt(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //CancelApprovalRequest : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //CancelApprovalRequest : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "ApplyTemplate(Action 131).OnAction.ConfigTemplateMgt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //ApplyTemplate : 8612;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //ApplyTemplate : "Config. Template Management";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Control 92.OnDrillDown.VendLedgEntry(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Control 92.OnDrillDown.VendLedgEntry : 1001;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Control 92.OnDrillDown.VendLedgEntry : 1102152001;
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Control 92.OnDrillDown.VendLedgEntry(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Control 92.OnDrillDown.VendLedgEntry : 25;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Control 92.OnDrillDown.VendLedgEntry : "Vendor Ledger Entry";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Control 92.OnDrillDown.DtldVendLedgEntry(Variable 1002)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Control 92.OnDrillDown.DtldVendLedgEntry : 1002;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Control 92.OnDrillDown.DtldVendLedgEntry : 1102152000;
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Control 92.OnDrillDown.DtldVendLedgEntry(Variable 1002)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Control 92.OnDrillDown.DtldVendLedgEntry : 380;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Control 92.OnDrillDown.DtldVendLedgEntry : "Detailed Vendor Ledg. Entry";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Control 23.OnDrillDown.VATRegistrationLogMgt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Control 23.OnDrillDown.VATRegistrationLogMgt : 249;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Control 23.OnDrillDown.VATRegistrationLogMgt : "VAT Registration Log Mgt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "OnOpenPage.MapMgt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //OnOpenPage.MapMgt : 802;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //OnOpenPage.MapMgt : "Online Map Management";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "SetSocialListeningFactboxVisibility(PROCEDURE 1).SocialListeningMgt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //SetSocialListeningFactboxVisibility : 871;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //SetSocialListeningFactboxVisibility : "Social Listening Management";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "CalendarMgmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //CalendarMgmt : 7600;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //CalendarMgmt : "Calendar Management";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "PaymentToleranceMgt(Variable 1002)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //PaymentToleranceMgt : 426;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //PaymentToleranceMgt : "Payment Tolerance Management";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "ApprovalsMgmt(Variable 1010)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //ApprovalsMgmt : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //ApprovalsMgmt : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "CustomizedCalEntry(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //CustomizedCalEntry : 7603;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //CustomizedCalEntry : "Customized Calendar Entry";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "CustomizedCalendar(Variable 1003)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //CustomizedCalendar : 7602;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //CustomizedCalendar : "Customized Calendar Change";
        //Variable type has not been exported.

    var
        CASHFLOWCONNECTION : Codeunit "Cash Flow Connection";
        cat : Integer;
        Payment_Mode : Code[10];

    var
        PLGrec : Record "Purchase Line";
        Text003 : Label 'The email address "%1" is invalid.';
        tempstr : Text;
        position1 : Integer;
        charvar : Char;
        name1 : Text;
        name2 : Text;
        position2 : Integer;
        MobileNo : Code[100];
        MINIMUMORDERVALCHECK : Boolean;
        SMTP_MAIL : Codeunit "SMTP Mail";
        Manager_Appr : Boolean;


    //Unsupported feature: CodeModification on "OnAfterGetCurrRecord". Please convert manually.

    //trigger OnAfterGetCurrRecord();
    //>>>> ORIGINAL CODE:
    //begin
        /*
        ActivateFields;
        OpenApprovalEntriesExistCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
        OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
        ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
        */
    //end;
    //>>>> MODIFIED CODE:
    //begin
        /*
        //ActivateFields;
        #2..4
        */
    //end;


    //Unsupported feature: CodeModification on "OnInit". Please convert manually.

    //trigger OnInit();
    //Parameters and return type have not been exported.
    //>>>> ORIGINAL CODE:
    //begin
        /*
        ContactEditable := TRUE;
        "P.A.N. No.Editable" := TRUE;
        MapPointVisible := TRUE;
        */
    //end;
    //>>>> MODIFIED CODE:
    //begin
        /*
        ContactEditable := TRUE;
        //"P.A.N. No.Editable" := TRUE;
        //MapPointVisible := TRUE;
        */
    //end;


    //Unsupported feature: CodeInsertion on "OnInsertRecord". Please convert manually.

    //trigger OnInsertRecord(BelowxRec : Boolean) : Boolean;
    //begin
        /*
        "User Id" := USERID;
        */
    //end;


    //Unsupported feature: CodeInsertion on "OnModifyRecord". Please convert manually.

    //trigger OnModifyRecord() : Boolean;
    //begin
        /*
        {IF "Updated in Cashflow" = TRUE THEN
        BEGIN

          TESTFIELD(Name);
          TESTFIELD(City);
          IF category=category::Primary THEN
            cat:=1
          ELSE IF category=category::Secondary THEN
            cat:=2
          ELSE IF category=category::Lower THEN
            cat:=3;
          IF cat=0  THEN
          ERROR('Select category for Vendor');
          IF "Purchaser Code" = '' THEN
            ERROR('Please select Purchaser Code!');     //added by pranavi on 18-jun-2016


          IF "Vendor Posting Group"<>'FOREIGN' THEN
          TESTFIELD("State Code");

          IF "Payment Method Code" ='CHQ' THEN
            Payment_Mode:='CHEQUE'
          ELSE
            Payment_Mode:="Payment Method Code";
          //Added By Pranavi
          IF Name <> '' THEN
          BEGIN
            position1 := STRPOS(Name,FORMAT(charvar));
            IF position1 > 0 THEN
              name1 := DELSTR(Name,position1,1)
            ELSE
              name1:=Name;
          END;
          IF "Name 2" <> '' THEN
          BEGIN
            position2 := STRPOS("Name 2",FORMAT(charvar));
            IF position2 > 0 THEN
              name2 := DELSTR("Name 2",position2,1)
            ELSE
              name2:="Name 2";
          END;
          //End By Pranavi
          //Added by Pranavi on 24-Dec-2015
          IF  "Payment Method Code" = 'RTGS' THEN
          BEGIN
            IF "RTGS Code" = '' THEN
              ERROR('Please enter RTGS CODE in Payments Tab as payment method is RTGS!');
            IF "Our Account No." = '' THEN
              ERROR('Please enter Our Account No. in Payments Tab as payment method is RTGS!');
            IF "Name of Bank" = '' THEN
              ERROR('Please enter Name of Bank in Payments Tab as payment method is RTGS!');
            IF "Branch Name" = '' THEN
              ERROR('Please enter Branch Name in Payments Tab as payment method is RTGS!');
          END;
          //End by Pranavi
          // Added by Pranavi on 24-feb-2016 for TIN number validation
          IF ("T.I.N. No." = '') AND ("T.I.N Status" IN["T.I.N Status"::" ","T.I.N Status"::TINAPPLIED]) THEN
            ERROR('Please enter T.I.N Number in Tax Information Tab!');
          // End by Pranavi
            MESSAGE('update MRP_ERP_VENDOR set NAME = '''+ CommaRemoval(name1+' '+name2)+
                                ''',CITY = '''+CommaRemoval(City)+ ''',DETAIL= '''+CommaRemoval(name1)+ ''',STATE = ''' +CommaRemoval("State Code")+
                                ''',CUST_CATEGORY = '''+FORMAT(cat)+ ''',BANKNAME = '''+"Name of Bank"+ ''',BRANCHNAME = '''+"Branch Name"+
                                ''',ACCOUNTNO = '''+"Our Account No."+ ''', RTGSCODE = '''+"RTGS Code"+ ''',PAY_MODE = '''+ Payment_Mode +
                                ''',EMAIL_ID = '''+"E-Mail"+''',CONTACT_PERSON = '''+Contact+
                                ''',CONTACT_PHONE = '''+ "Phone No."+''' where VENDOR_ID = '''+ "No." +'''');


            CASHFLOWCONNECTION.ExecInOracle('update MRP_ERP_VENDOR set NAME = '''+ CommaRemoval(name1+' '+name2)+
                                ''',CITY = '''+CommaRemoval(City)+ ''',DETAIL= '''+CommaRemoval(name1)+ ''',STATE = ''' +CommaRemoval("State Code")+
                                ''',CUST_CATEGORY = '''+FORMAT(cat)+ ''',BANKNAME = '''+"Name of Bank"+ ''',BRANCHNAME = '''+"Branch Name"+
                                ''',ACCOUNTNO = '''+"Our Account No."+ ''', RTGSCODE = '''+"RTGS Code"+ ''',PAY_MODE = '''+ Payment_Mode +
                                ''',EMAIL_ID = '''+"E-Mail"+''',CONTACT_PERSON = '''+Contact+
                                ''',CONTACT_PHONE = '''+ "Phone No."+''' where VENDOR_ID = '''+ "No." +'''');

        END  ;
                          }
        */
    //end;


    //Unsupported feature: CodeModification on "OnOpenPage". Please convert manually.

    //trigger OnOpenPage();
    //>>>> ORIGINAL CODE:
    //begin
        /*
        ActivateFields;
        IF NOT MapMgt.TestSetup THEN
          MapPointVisible := FALSE;
        */
    //end;
    //>>>> MODIFIED CODE:
    //begin
        /*
        #1..3

        IF NOT SMTP_MAIL.Permission_Checking(USERID,'VENDOR_MINIMUMORDER_') THEN
          MINIMUMORDERVALCHECK := FALSE
          ELSE
          MINIMUMORDERVALCHECK := TRUE;
        //VENDOR_APPROVAL
        IF NOT SMTP_MAIL.Permission_Checking(USERID,'VENDOR_APPROVAL') THEN
          Manager_Appr := FALSE
        ELSE
          Manager_Appr := TRUE;
        */
    //end;


    //Unsupported feature: CodeModification on "ActivateFields(PROCEDURE 3)". Please convert manually.

    //procedure ActivateFields();
    //Parameters and return type have not been exported.
    //>>>> ORIGINAL CODE:
    //begin
        /*
        SetSocialListeningFactboxVisibility;
        ContactEditable := "Primary Contact No." = '';
        "P.A.N. No.Editable" := "P.A.N. Status" = 0;
        */
    //end;
    //>>>> MODIFIED CODE:
    //begin
        /*
        SetSocialListeningFactboxVisibility;
        //CurrPage.Contact.EDITABLE("Primary Contact No." = '');
        "P.A.N. No.Editable" := ("P.A.N. Status" = 0);
        */
    //end;

    [LineStart(1220)]
    procedure CommaRemoval(Base : Text[100]) Converted : Text[50];
    var
        i : Integer;
    begin
         FOR i:=1 TO STRLEN(Base) DO
         BEGIN
           IF COPYSTR(Base,i,1)<>',' THEN
             Converted+=COPYSTR(Base,i,1);
         END;
         EXIT(Converted);
    end;

    [LineStart(1234)]
    local procedure CheckValidEmailAddresses(Recipients : Text);
    var
        TmpRecipients : Text;
    begin
        IF Recipients <> '' THEN
        BEGIN
          TmpRecipients := Recipients;
          WHILE STRPOS(TmpRecipients,',') > 1 DO BEGIN
            CheckValidEmailAddress(COPYSTR(TmpRecipients,1,STRPOS(TmpRecipients,',') - 1));
            TmpRecipients := COPYSTR(TmpRecipients,STRPOS(TmpRecipients,',') + 1);
          END;
          CheckValidEmailAddress(TmpRecipients);
        END;
    end;

    [LineStart(1245)]
    local procedure CheckValidEmailAddress(EmailAddress : Text);
    var
        i : Integer;
        NoOfAtSigns : Integer;
    begin

        IF (EmailAddress[1] = '@') OR (EmailAddress[STRLEN(EmailAddress)] = '@') THEN
          ERROR(Text003,EmailAddress);

        FOR i := 1 TO STRLEN(EmailAddress) DO BEGIN
          IF EmailAddress[i] = '@' THEN
            NoOfAtSigns := NoOfAtSigns + 1;
          IF NOT (
                  ((EmailAddress[i] >= 'a') AND (EmailAddress[i] <= 'z')) OR
                  ((EmailAddress[i] >= 'A') AND (EmailAddress[i] <= 'Z')) OR
                  ((EmailAddress[i] >= '0') AND (EmailAddress[i] <= '9')) OR
                  ((NoOfAtSigns = 0) AND (EmailAddress[i] IN ['!','#','$','%','&','''',
                                                              '*','+','-','/','=','?',
                                                              '^','_','`','.','{','|',
                                                              '}','~'])) OR
                  ((NoOfAtSigns > 0) AND (EmailAddress[i] IN ['@','.','-','[',']'])))
          THEN
            ERROR(Text003,EmailAddress);
        END;

        IF NoOfAtSigns <> 1 THEN
          ERROR(Text003,EmailAddress);
    end;

    [LineStart(1269)]
    procedure GSTMails();
    var
        Type : Code[2];
        No : Code[20];
        Subject : Text[1000];
        Mail_To : Text[1000];
        Mail_From : Text[1000];
        SMTP_MAIL : Codeunit "SMTP Mail";
        SQLQuery : Text[1024];
        RowCount : Integer;
        SQLConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000514-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Connection";
        RecordSet : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000535-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Recordset";
        TempText : Text;
        ConnectionOpen : Integer;
        Body : Text;
        Attachment : Text;
    begin
        IF ISCLEAR(SQLConnection) THEN
          CREATE(SQLConnection,FALSE,TRUE);

        IF ISCLEAR(RecordSet) THEN
          CREATE(RecordSet,FALSE,TRUE);
        ConnectionOpen:=0;
        IF ConnectionOpen <> 1 THEN
        BEGIN
          SQLConnection.ConnectionString:='DSN=salinvoiceuser;UID=salinvoiceuser;PASSWORD=salinvoiceuser;SERVER=oracle_80;';
          SQLConnection.Open;
          //SQLConnection.BeginTrans;
          ConnectionOpen:=1;
        END;
        //SQLQuery := 'select * from Vendor_Cust_List where NO in(''CUST00971'',''CUST00972'') and (MAIL_SEND_COUNT <=0 or MAIL_SEND_COUNT is null) order by type,no;';
        SQLQuery := 'select * from Vendor_Cust_List where NO = '''+"No."+''' order by type,no;';
        //MESSAGE(SQLQuery);
        RecordSet := SQLConnection.Execute(SQLQuery,RowCount);
        IF NOT( (RecordSet.BOF) OR (RecordSet.EOF)) THEN
          RecordSet.MoveFirst;
        WHILE NOT RecordSet.EOF DO
        BEGIN
          Type := FORMAT(RecordSet.Fields.Item('TYPE').Value);
          No := FORMAT(RecordSet.Fields.Item('NO').Value);
          IF Type = 'V' THEN
            Mail_From :='purchase@efftronics.com'
          ELSE
            Mail_From :='sales@efftronics.com';
          Mail_To := FORMAT(RecordSet.Fields.Item('EMAIL').Value);
          Mail_To := 'pranavi@efftronics.com';

          Subject := 'Reg : GST Information Requirements from Efftronics System Pvt Ltd.,!';
          Body := '<html><head><style> divone{background-color: white; width: 1210px; padding: 20px; border-style:solid ; border-color:#666699;  margin: 20px;} </style></head>';
          Body := Body+'<body><div style="border-color:#666699; margin: 20px; border-width:15px; border-style:solid; padding: 20px; width: 1110px;"><label><font size="6">GST Information Requirements from Efftronics System Pvt Ltd.,!</font></label>';
          Body := Body+'<hr style=solid; color= #3333CC>';
          Body := Body+'<h>Dear Sir/Madam,</h><br><br>';
          Body := Body+'<P> As you are aware, GST Roll out is likely to be from 01st July 2017. </P>';
          Body := Body+'<P> We need to update our records with the Provisional GSTIN Registration Numbers of all our Vendors/Customers. ';
          Body := Body+'Request you to kindly update PAN & GST registration provisional ID in <b><font color="red">below link</font></b> immediately.</P><br/>';
          //Body := Body+'<b>URL :</b><a href="http://localhost:51203/GSTRegistrationDetails.aspx?&V_C_Num=';
          Body := Body+'<font size="6"><b>URL :</b><b><a href="http://app.efftronics.org:8567/GST_Registration/GSTRegistrationDetails.aspx?V_C_Num=';
          //Body := Body+'<font size="6"><b>URL :</b><b><a href="http://app.efftronics.org:8567/GST_Reg_Internal/GSTRegistrationDetails.aspx?V_C_Num=';
          Body := Body+No+'" target="_blank">GST Registration Details</a></b></font><br/><br/>';
          Body := Body+'Please note that this is required to have smooth business transaction after GST implementation effective July 1, 2017.<br/><br/>';
          Body := Body+'Our Company GST Registration details are also attached for your information.<br/><br/>';
          Body := Body+'In case you have any queries please contact undersigned.<br/><br/>';
          Body := Body+'Best Regards,<br/>';
          IF Type = 'V' THEN
          BEGIN
            Body := Body+'Renuka CH<br/>';
            Body := Body+'Purchase Department<br/>';
            Body := Body+'Efftronics Systems Pvt. Ltd.,<br/>';
            Body := Body+'40-15-9,Brundavan Colony,<br/>';
            Body := Body+'Vijayawada - 520010,<br/>';
            Body := Body+'Andhra Pradesh, India.<br/>';
            Body := Body+'Ph No : 0866-2466679(Direct)/2466699/75<br/>';
          END ELSE
          BEGIN
            Body := Body+'S.Ganesh<br/>';
            Body := Body+'Finance Department<br/>';
            Body := Body+'Efftronics Systems Pvt. Ltd.,<br/>';
            Body := Body+'40-15-9,Brundavan Colony,<br/>';
            Body := Body+'Vijayawada - 520010,<br/>';
            Body := Body+'Andhra Pradesh, India.<br/>';
            Body := Body+'Mobile : 9394654999<br/>';
            Body := Body+'Ph No : 0866-2466675(Direct)/2466699/75<br/>';
          END;
          SMTP_MAIL.CreateMessage('ERP',Mail_From,Mail_To,Subject,Body,TRUE);
          Attachment:='\\erpserver\ErpAttachments\Efftronics_GST_Details.pdf';
          SMTP_MAIL.AddAttachment(Attachment,'');
          SMTP_MAIL.AddCC('erp@efftronics.com');
          SMTP_MAIL.Send;
          SQLQuery := 'update Vendor_Cust_List set MAIL_SEND_COUNT = nvl(MAIL_SEND_COUNT,0)+1 where NO = '''+No+'''';
          //MESSAGE(SQLQuery);
          SQLConnection.BeginTrans;
          SQLConnection.Execute(SQLQuery);
          SQLConnection.CommitTrans;
          TempText:=TempText+No+',';
          RowCount:=RowCount+1;
          RecordSet.MoveNext;
        END;
        //RecordSet.Close;
        //SQLConnection.CommitTrans;
        SQLConnection.Close;
        ConnectionOpen:=0;
        IF STRLEN(TempText) > 1 THEN
          MESSAGE('Mail Has been send to '+COPYSTR(TempText,1,STRLEN(TempText)-1)+' - '+Name+' at '+Mail_To);
    end;

    //Unsupported feature: PropertyChange. Please convert manually.


    //Unsupported feature: PropertyChange. Please convert manually.


    //Unsupported feature: PropertyChange. Please convert manually.

}


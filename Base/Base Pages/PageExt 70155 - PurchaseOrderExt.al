pageextension 70155 PurchaseOrderExt extends "Purchase Order"
{
    // version NAVW19.00.00.51685,NAVIN9.00.00.51685,TFS223871,QC1.0,Rev01,SQL,EFFUPG

    layout
    {

        //Unsupported feature: Change Name on "Control 1900000001". Please convert manually.


        //Unsupported feature: Change Name on "Control 1". Please convert manually.


        //Unsupported feature: Change Name on "Control 2". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 2". Please convert manually.


        //Unsupported feature: Change Name on "Control 4". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 4". Please convert manually.


        //Unsupported feature: Change Name on "Control 174". Please convert manually.


        //Unsupported feature: Change Editable on "Control 174". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 174". Please convert manually.


        //Unsupported feature: Change Name on "Control 6". Please convert manually.


        //Unsupported feature: Change Editable on "Control 6". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 6". Please convert manually.


        //Unsupported feature: Change Name on "Control 89". Please convert manually.


        //Unsupported feature: Change Editable on "Control 89". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 89". Please convert manually.


        //Unsupported feature: Change Name on "Control 91". Please convert manually.


        //Unsupported feature: Change Editable on "Control 91". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 91". Please convert manually.


        //Unsupported feature: Change Name on "Control 76". Please convert manually.


        //Unsupported feature: Change Editable on "Control 76". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 76". Please convert manually.


        //Unsupported feature: Change Name on "Control 93". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 93". Please convert manually.


        //Unsupported feature: Change Name on "Control 8". Please convert manually.


        //Unsupported feature: Change Editable on "Control 8". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 8". Please convert manually.


        //Unsupported feature: Change Name on "Control 171". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 171". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500014". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500014". Please convert manually.


        //Unsupported feature: Change Name on "Control 12". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 12". Please convert manually.


        //Unsupported feature: Change Name on "Control 49". Please convert manually.


        //Unsupported feature: Change Editable on "Control 49". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 49". Please convert manually.


        //Unsupported feature: Change Name on "Control 16". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 16". Please convert manually.


        //Unsupported feature: Change Name on "Control 18". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 18". Please convert manually.


        //Unsupported feature: Change Name on "Control 20". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 20". Please convert manually.


        //Unsupported feature: Change Name on "Control 96". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 96". Please convert manually.


        //Unsupported feature: Change Name on "Control 10". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 10". Please convert manually.


        //Unsupported feature: Change Name on "Control 131". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 131". Please convert manually.


        //Unsupported feature: Change Name on "Control 72". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 72". Please convert manually.


        //Unsupported feature: Change Name on "Control 7". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 7". Please convert manually.


        //Unsupported feature: Change Name on "Control 133". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 133". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500987". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500987". Please convert manually.


        //Unsupported feature: Change PagePartID on "PurchLines(Control 60)". Please convert manually.


        //Unsupported feature: Change Name on "Control 1905885101". Please convert manually.


        //Unsupported feature: Change Name on "Control 22". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 22". Please convert manually.


        //Unsupported feature: Change Name on "Control 176". Please convert manually.


        //Unsupported feature: Change Editable on "Control 176". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 176". Please convert manually.


        //Unsupported feature: Change Name on "Control 24". Please convert manually.


        //Unsupported feature: Change Editable on "Control 24". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 24". Please convert manually.

        modify("Control 26")
        {

            //Unsupported feature: Change Name on "Control 26". Please convert manually.

            Enabled = TRUE;

            //Unsupported feature: Change Editable on "Control 26". Please convert manually.


            //Unsupported feature: Change ImplicitType on "Control 26". Please convert manually.

        }

        //Unsupported feature: Change Name on "Control 28". Please convert manually.


        //Unsupported feature: Change Editable on "Control 28". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 28". Please convert manually.


        //Unsupported feature: Change Name on "Control 97". Please convert manually.


        //Unsupported feature: Change Editable on "Control 97". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 97". Please convert manually.


        //Unsupported feature: Change Name on "Control 30". Please convert manually.


        //Unsupported feature: Change Editable on "Control 30". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 30". Please convert manually.


        //Unsupported feature: Change Name on "Control 32". Please convert manually.


        //Unsupported feature: Change Editable on "Control 32". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 32". Please convert manually.


        //Unsupported feature: Change Name on "Control 34". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 34". Please convert manually.


        //Unsupported feature: Change Name on "Control 36". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 36". Please convert manually.


        //Unsupported feature: Change Name on "Control 38". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 38". Please convert manually.


        //Unsupported feature: Change Name on "Control 40". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 40". Please convert manually.


        //Unsupported feature: Change Name on "Control 117". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 117". Please convert manually.


        //Unsupported feature: Change Name on "Control 27". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 27". Please convert manually.


        //Unsupported feature: Change Name on "Control 25". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 25". Please convert manually.


        //Unsupported feature: Change Name on "Control 106". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 106". Please convert manually.


        //Unsupported feature: Change Name on "Control 135". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 135". Please convert manually.


        //Unsupported feature: Change Name on "Control 191". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 191". Please convert manually.


        //Unsupported feature: Change Name on "Control 1906801201". Please convert manually.


        //Unsupported feature: Change Name on "Control 42". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 42". Please convert manually.


        //Unsupported feature: Change Name on "Control 44". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 44". Please convert manually.


        //Unsupported feature: Change Name on "Control 46". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 46". Please convert manually.

        modify("Control 109")
        {

            //Unsupported feature: Change Name on "Control 109". Please convert manually.

            CaptionML = ENU = 'Ship-to Post Code/City';

            //Unsupported feature: Change ImplicitType on "Control 109". Please convert manually.

        }

        //Unsupported feature: Change Name on "Control 50". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 50". Please convert manually.


        //Unsupported feature: Change Name on "Control 48". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 48". Please convert manually.


        //Unsupported feature: Change Name on "Control 104". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 104". Please convert manually.


        //Unsupported feature: Change Name on "Control 144". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 144". Please convert manually.


        //Unsupported feature: Change Name on "Control 52". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 52". Please convert manually.


        //Unsupported feature: Change Name on "Control 146". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 146". Please convert manually.


        //Unsupported feature: Change Name on "Control 139". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 139". Please convert manually.


        //Unsupported feature: Change Name on "Control 54". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 54". Please convert manually.


        //Unsupported feature: Change Name on "Control 87". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 87". Please convert manually.


        //Unsupported feature: Change Name on "Control 85". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 85". Please convert manually.


        //Unsupported feature: Change Name on "Control 1520001". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1520001". Please convert manually.


        //Unsupported feature: Change Name on "Control 1907468901". Please convert manually.


        //Unsupported feature: Change Name on "Control 119". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 119". Please convert manually.


        //Unsupported feature: Change Name on "Control 56". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 56". Please convert manually.


        //Unsupported feature: Change Name on "Control 115". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 115". Please convert manually.


        //Unsupported feature: Change Name on "Control 58". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 58". Please convert manually.


        //Unsupported feature: Change Name on "Control 111". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 111". Please convert manually.


        //Unsupported feature: Change Name on "Control 113". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 113". Please convert manually.


        //Unsupported feature: Change Name on "Control 1900201301". Please convert manually.


        //Unsupported feature: Change Name on "Control 197". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 197". Please convert manually.


        //Unsupported feature: Change Name on "Control 199". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 199". Please convert manually.


        //Unsupported feature: Change Name on "Control 215". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 215". Please convert manually.


        //Unsupported feature: Change Name on "Control 212". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 212". Please convert manually.


        //Unsupported feature: Change Name on "Control 217". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 217". Please convert manually.


        //Unsupported feature: Change Name on "Control 196". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 196". Please convert manually.


        //Unsupported feature: Change Name on "Control 207". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 207". Please convert manually.


        //Unsupported feature: Change Name on "Control 1904409301". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500000". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500000". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500001". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500001". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500002". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500002". Please convert manually.


        //Unsupported feature: Change Name on "Control 1902697801". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500007". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500007". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500006". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500006". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500008". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500008". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500009". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500009". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500031". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500031". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500025". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500025". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500018". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500018". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500016". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500016". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500017". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500017". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500024". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500024". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500047". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500047". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500049". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500049". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500051". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500051". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500101". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500101". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500102". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500102". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500012". Please convert manually.


        //Unsupported feature: Change Editable on "Control 1500012". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500012". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500015". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500015". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500011". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500011". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500019". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500019". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500450". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500450". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500004". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500004". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500005". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500005". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500010". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500010". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500113". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500113". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500118". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500118". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500114". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500114". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500020". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500020". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500026". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500026". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500021". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500021". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500022". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500022". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500023". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500023". Please convert manually.


        //Unsupported feature: Change Name on "Control 1510023". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1510023". Please convert manually.


        //Unsupported feature: Change Name on "Control 1510024". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1510024". Please convert manually.


        //Unsupported feature: Change Name on "Control 1510025". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1510025". Please convert manually.


        //Unsupported feature: Change Name on "Control 1510026". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1510026". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500027". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500027". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500003". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500003". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500029". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500029". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500030". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500030". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500060". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500032". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500032". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500033". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500033". Please convert manually.


        //Unsupported feature: Change Name on "Control 1500034". Please convert manually.


        //Unsupported feature: Change ImplicitType on "Control 1500034". Please convert manually.


        //Unsupported feature: Change Name on "Control 1900000007". Please convert manually.


        //Unsupported feature: Change SubPageLink on "Control 23". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 23". Please convert manually.


        //Unsupported feature: Change Name on "Control 23". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 1903326807". Please convert manually.


        //Unsupported feature: Change ProviderID on "Control 1903326807". Please convert manually.


        //Unsupported feature: Change Name on "Control 1903326807". Please convert manually.


        //Unsupported feature: Change PagePartID on "ApprovalFactBox(Control 1906354007)". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 1901138007". Please convert manually.


        //Unsupported feature: Change Name on "Control 1901138007". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 1904651607". Please convert manually.


        //Unsupported feature: Change Name on "Control 1904651607". Please convert manually.


        //Unsupported feature: Change PagePartID on "IncomingDocAttachFactBox(Control 39)". Please convert manually.


        //Unsupported feature: Change ShowFilter on "IncomingDocAttachFactBox(Control 39)". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 1903435607". Please convert manually.


        //Unsupported feature: Change Name on "Control 1903435607". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 1906949207". Please convert manually.


        //Unsupported feature: Change Name on "Control 1906949207". Please convert manually.


        //Unsupported feature: Change SubPageLink on "Control 3". Please convert manually.


        //Unsupported feature: Change PagePartID on "Control 3". Please convert manually.


        //Unsupported feature: Change ProviderID on "Control 3". Please convert manually.


        //Unsupported feature: Change Name on "Control 3". Please convert manually.


        //Unsupported feature: Change PagePartID on "WorkflowStatus(Control 59)". Please convert manually.


        //Unsupported feature: Change ShowFilter on "WorkflowStatus(Control 59)". Please convert manually.


        //Unsupported feature: Change Name on "Control 1900383207". Please convert manually.


        //Unsupported feature: Change Name on "Control 1905767507". Please convert manually.


        //Unsupported feature: CodeModification on "Control 4.OnValidate". Please convert manually.

        //trigger OnValidate();
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
        /*
        BuyfromVendorNoOnAfterValidate;
        */
        //end;
        //>>>> MODIFIED CODE:
        //begin
        /*
        Vendor_approved_or_Not; //added by vishnu Priya on 12-11-2020
        BuyfromVendorNoOnAfterValidate;
        */
        //end;
        modify("Control 14")
        {
            Visible = false;
        }
        modify("Control 237")
        {
            Visible = false;
        }
        modify("Control 100")
        {
            Visible = false;
        }
        modify("Control 102")
        {
            Visible = false;
        }


        //Unsupported feature: CodeModification on "Control 135.OnValidate". Please convert manually.

        //trigger OnValidate();
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
        /*
        PricesIncludingVATOnAfterValid;
        */
        //end;
        //>>>> MODIFIED CODE:
        //begin
        /*
        PricesIncludingVATOnAfterValid;//Rev01;
        */
        //end;
        modify("Control 127")
        {
            Visible = false;
        }
        addafter("Control 171")
        {
            field("Location Code"; "Location Code")
            {
                Caption = 'Location Code';
            }
            field("Shortcut Dimension 1 Code"; "Shortcut Dimension 1 Code")
            {

                trigger OnValidate();
                begin
                    ShortcutDimension1CodeOnAfterV; //Rev01
                end;
            }
            field("C Form"; "C Form")
            {
            }
            field("<Form Code 2 >"; "Form Code")
            {
            }
            field("First Release DateTime"; "First Release DateTime")
            {
                Editable = false;
            }
            field("Release Date Time"; "Release Date Time")
            {
                Editable = false;
            }
            field("Tender No"; "Tender No")
            {
            }
            field("Sale Order No"; "Sale Order No")
            {
            }
        }
        addafter("Control 12")
        {
            field("First Release By"; "First Release By")
            {
                Editable = false;
            }
            field("Released By"; "Released By")
            {
                Editable = false;
            }
            field("Order Date"; "Order Date")
            {
                Importance = Promoted;
            }
        }
        addafter("Control 49")
        {
            field("Inclusive of All Taxes"; "Inclusive of All Taxes")
            {
            }
        }
        addafter("Control 10")
        {
            field("Quotation Date"; "Quotation Date")
            {
            }
            field("Quotation No."; "Quotation No.")
            {
            }
            field("Requested Receipt Date"; "Requested Receipt Date")
            {
            }
            field("<Expected Receipt Date 2>"; "Expected Receipt Date")
            {
                Importance = Promoted;

                trigger OnValidate();
                begin
                    /*PurchLine.SETRANGE(PurchLine."Document No.","No.");
                   IF PurchLine.FINDSET THEN
                   REPEAT
                     PurchLine."Expected Receipt Date":="Expected Receipt Date";
                     PurchLine."Deviated Receipt Date":="Expected Receipt Date";
                     PurchLine.MODIFY;
                   UNTIL PurchLine.NEXT=0;*/
                    //  commented by sujani on 27-jul-18

                end;
            }
        }
        addafter("Control 72")
        {
            field("Shortcut Dimension 2 Code"; "Shortcut Dimension 2 Code")
            {
                Visible = false;

                trigger OnValidate();
                begin
                    ShortcutDimension2CodeOnAfterV;//Rev01
                end;
            }
        }
        addafter("Control 7")
        {
            field("Way bill"; "Way bill")
            {
            }
            field(Mail_Sent; Mail_Sent)
            {
                Editable = false;
            }
            field(Mail_count; Mail_count)
            {
                Caption = 'Mail Sent count';
                DecimalPlaces = 0 : 0;
                Editable = false;
            }
            field("Purchaser Code1"; "Purchaser Code")
            {
                CaptionML = ENU = 'Purchaser Code1',
                            ENN = 'Purchaser Code';
            }
            field("Acknowledge Given by"; "Acknowledge Given by")
            {
            }
            field("Acknowledged Dt"; "Acknowledged Dt")
            {
            }
        }
        addafter("Control 30")
        {
            field(State; State)
            {
            }
        }
        addafter("Control 32")
        {
            field("OrderCreated by"; "OrderCreated by")
            {
                Editable = false;
            }
            field("<Form No. 2>"; "Form No.")
            {
            }
        }
        addafter("Control 34")
        {
            field("Do not Consider GST"; "Do not Consider GST")
            {

                trigger OnValidate();
                begin
                    TESTFIELD(Status, Status::Open);
                    IF "Payment Terms Code" <> 'TOTADV' THEN
                        ERROR('This is only applicable for TOTAL ADVANCE payment terms');
                end;
            }
        }
        addafter("Control 191")
        {
            field(QA_Auth_Status; QA_Auth_Status)
            {
                Editable = false;
            }
            field(QA_Auth_Date; QA_Auth_Date)
            {
                Editable = false;
            }
        }
        addafter("Control 104")
        {
            field("Packing Type"; "Packing Type")
            {
            }
            field("Vendor Excise Invoice No."; "Vendor Excise Invoice No.")
            {
            }
            field("Vend. Excise Inv. Date"; "Vend. Excise Inv. Date")
            {
            }
        }
        addafter("Control 1520001")
        {
            field("Tax Area Code"; "Tax Area Code")
            {
            }
        }
        addafter("Control 113")
        {
            field("MSPT Date"; "MSPT Date")
            {
            }
            field("MSPT Code"; "MSPT Code")
            {
            }
            field("Receiving No."; "Receiving No.")
            {
            }
            field("Posting No."; "Posting No.")
            {
            }
            field("Posting No. Series"; "Posting No. Series")
            {
            }
            field("Receiving No. Series"; "Receiving No. Series")
            {
            }
        }
        addafter("Control 1500017")
        {
            field("Tax Liable"; "Tax Liable")
            {
            }
        }
        addafter("Control 1500051")
        {
            group(GST)
            {
                CaptionML = ENU = 'GST',
                            ENN = 'GST';
            }
        }
        addafter("Control 1500102")
        {
            field("Nature of Supply"; "Nature of Supply")
            {
            }
        }
    }
    actions
    {

        //Unsupported feature: Change Name on "Action 1900000003". Please convert manually.


        //Unsupported feature: Change Name on "Action 61". Please convert manually.

        modify(Dimensions)
        {

            //Unsupported feature: Change AccessByPermission on "Dimensions(Action 129)". Please convert manually.

            Promoted = false;
            PromotedIsBig = false;
        }
        modify(Statistics)
        {
            Promoted = true;
            PromotedIsBig = true;
        }
        modify("Action 64")
        {

            //Unsupported feature: Change RunObject on "Action 64". Please convert manually.

            Promoted = false;
            PromotedIsBig = false;

            //Unsupported feature: Change Name on "Action 64". Please convert manually.

        }

        //Unsupported feature: Change Name on "Action 53". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 65". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 65". Please convert manually.


        //Unsupported feature: Change Name on "Action 65". Please convert manually.


        //Unsupported feature: Change Name on "Action 9". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 66". Please convert manually.


        //Unsupported feature: Change Name on "Action 66". Please convert manually.

        modify("Action 67")
        {

            //Unsupported feature: Change RunObject on "Action 67". Please convert manually.

            Promoted = false;
            PromotedIsBig = false;

            //Unsupported feature: Change Name on "Action 67". Please convert manually.

        }

        //Unsupported feature: Change RunObject on "PostedPrepaymentInvoices(Action 205)". Please convert manually.


        //Unsupported feature: Change RunObject on "PostedPrepaymentCrMemos(Action 206)". Please convert manually.


        //Unsupported feature: Change Name on "Action 11". Please convert manually.


        //Unsupported feature: Change Name on "Action 181". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 180". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 180". Please convert manually.


        //Unsupported feature: Change Name on "Action 180". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 148". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 148". Please convert manually.


        //Unsupported feature: Change Name on "Action 148". Please convert manually.


        //Unsupported feature: Change Name on "Action 182". Please convert manually.


        //Unsupported feature: Change Name on "Action 183". Please convert manually.


        //Unsupported feature: Change RunObject on ""Warehouse_GetSalesOrder"(Action 226)". Please convert manually.


        //Unsupported feature: Change Name on "Action 227". Please convert manually.


        //Unsupported feature: Change AccessByPermission on "Action 228". Please convert manually.


        //Unsupported feature: Change Name on "Action 228". Please convert manually.


        //Unsupported feature: Change Name on "Action 1900000004". Please convert manually.


        //Unsupported feature: Change Name on "Action 37". Please convert manually.

        modify(Approve)
        {
            Promoted = true;
            PromotedIsBig = true;
        }
        modify(Reject)
        {
            Promoted = true;
            PromotedIsBig = true;
        }
        modify(Delegate)
        {
            Promoted = true;
        }
        modify(Comment)
        {
            Promoted = true;
        }

        //Unsupported feature: Change Name on "Action 13". Please convert manually.


        //Unsupported feature: Change Name on "Action 73". Please convert manually.

        modify(Release)
        {
            Promoted = true;
        }
        modify(Reopen)
        {
            ShortCutKey = Ctrl+Alt+O;
        }

        //Unsupported feature: Change Name on "Action 611". Please convert manually.


        //Unsupported feature: Change Name on "Action 68". Please convert manually.


        //Unsupported feature: Change AccessByPermission on "CalculateInvoiceDiscount(Action 69)". Please convert manually.


        //Unsupported feature: Change Name on "Action 190". Please convert manually.


        //Unsupported feature: Change Ellipsis on "Action 179". Please convert manually.


        //Unsupported feature: Change Name on "Action 179". Please convert manually.


        //Unsupported feature: Change Name on "Action 75". Please convert manually.

        modify(CopyDocument)
        {

            //Unsupported feature: Change Ellipsis on "CopyDocument(Action 70)". Please convert manually.

            Promoted = true;
        }

        //Unsupported feature: Change Ellipsis on "MoveNegativeLines(Action 142)". Please convert manually.

        modify("Update Reference Invoice No")
        {
            Promoted = true;
        }

        //Unsupported feature: Change Name on "Action 225". Please convert manually.


        //Unsupported feature: Change RunObject on ""Functions_GetSalesOrder"(Action 184)". Please convert manually.


        //Unsupported feature: Change Name on "Action 186". Please convert manually.


        //Unsupported feature: Change AccessByPermission on "Action 187". Please convert manually.


        //Unsupported feature: Change Name on "Action 187". Please convert manually.


        //Unsupported feature: Change Name on "Action 1500035". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 1500036". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 1500036". Please convert manually.


        //Unsupported feature: Change Name on "Action 1500036". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 1500037". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 1500037". Please convert manually.


        //Unsupported feature: Change Name on "Action 1500037". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 1500038". Please convert manually.


        //Unsupported feature: Change Name on "Action 1500038". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 1500039". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 1500039". Please convert manually.


        //Unsupported feature: Change Name on "Action 1500039". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 1500028". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 1500028". Please convert manually.


        //Unsupported feature: Change Name on "Action 1500028". Please convert manually.


        //Unsupported feature: Change RunObject on "Action 1500013". Please convert manually.


        //Unsupported feature: Change RunPageLink on "Action 1500013". Please convert manually.


        //Unsupported feature: Change Name on "Action 1500013". Please convert manually.


        //Unsupported feature: Change AccessByPermission on "Action 195". Please convert manually.


        //Unsupported feature: Change Name on "Action 195". Please convert manually.


        //Unsupported feature: Change Name on "Action 1500040". Please convert manually.

        modify("Action 1500041")
        {

            //Unsupported feature: Change Name on "Action 1500041". Please convert manually.

            ShortCutKey = Ctrl+F7;
        }

        //Unsupported feature: Change Image on "Action 1500042". Please convert manually.


        //Unsupported feature: Change Name on "Action 1500042". Please convert manually.


        //Unsupported feature: Change Name on "Action 189". Please convert manually.


        //Unsupported feature: Change AccessByPermission on "SelectIncomingDoc(Action 45)". Please convert manually.


        //Unsupported feature: Change Ellipsis on "IncomingDocAttachFile(Action 43)". Please convert manually.


        //Unsupported feature: Change Name on "Action 15". Please convert manually.

        modify(SendApprovalRequest)
        {
            Promoted = true;
        }
        modify(CancelApprovalRequest)
        {
            Promoted = true;
        }

        //Unsupported feature: Change Name on "Action 17". Please convert manually.


        //Unsupported feature: Change AccessByPermission on "Action 149". Please convert manually.


        //Unsupported feature: Change Name on "Action 149". Please convert manually.

        modify("Action 150")
        {

            //Unsupported feature: Change AccessByPermission on "Action 150". Please convert manually.


            //Unsupported feature: Change Ellipsis on "Action 150". Please convert manually.

            Promoted = true;

            //Unsupported feature: Change Name on "Action 150". Please convert manually.

        }

        //Unsupported feature: Change Name on "Action 1500043". Please convert manually.


        //Unsupported feature: Change Name on "Action 74". Please convert manually.


        //Unsupported feature: Change Name on "Action 77". Please convert manually.

        modify(Post)
        {

            //Unsupported feature: Change Ellipsis on "Post(Action 79)". Please convert manually.

            Promoted = true;
            PromotedIsBig = true;
        }
        modify("Action 80")
        {

            //Unsupported feature: Change Ellipsis on "Action 80". Please convert manually.

            Promoted = true;
            PromotedIsBig = true;

            //Unsupported feature: Change Name on "Action 80". Please convert manually.

        }

        //Unsupported feature: Change Ellipsis on "Action 78". Please convert manually.


        //Unsupported feature: Change Name on "Action 78". Please convert manually.


        //Unsupported feature: Change Ellipsis on "Action 81". Please convert manually.


        //Unsupported feature: Change Name on "Action 81". Please convert manually.

        modify("Action 1500046")
        {

            //Unsupported feature: Change Name on "Action 1500046". Please convert manually.

            ToolTipML = ENU='Print Deferment Schedule';
        }

        //Unsupported feature: Change Name on "Action 5". Please convert manually.


        //Unsupported feature: Change Name on "Action 201". Please convert manually.


        //Unsupported feature: Change Name on "Action 209". Please convert manually.


        //Unsupported feature: Change Ellipsis on "Action 202". Please convert manually.


        //Unsupported feature: Change Name on "Action 202". Please convert manually.


        //Unsupported feature: Change Ellipsis on "PostPrepaymentInvoice(Action 203)". Please convert manually.


        //Unsupported feature: Change Ellipsis on "Action 210". Please convert manually.


        //Unsupported feature: Change Name on "Action 210". Please convert manually.


        //Unsupported feature: Change Ellipsis on "PostPrepaymentCreditMemo(Action 204)". Please convert manually.


        //Unsupported feature: Change Ellipsis on "Action 211". Please convert manually.


        //Unsupported feature: Change Name on "Action 211". Please convert manually.


        //Unsupported feature: Change Name on "Action 19". Please convert manually.

        modify("Action 82")
        {

            //Unsupported feature: Change Ellipsis on "Action 82". Please convert manually.

            Promoted = true;

            //Unsupported feature: Change Name on "Action 82". Please convert manually.

        }


        //Unsupported feature: CodeModification on "Release(Action 137).OnAction". Please convert manually.

        //trigger OnAction();
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
            /*
            ReleasePurchDoc.PerformManualRelease(Rec);
            */
        //end;
        //>>>> MODIFIED CODE:
        //begin
            /*
            // Added by Rakesh to restrict items with unit cost zero on 15-Oct-14



            IF Rec."No." ='EFF/18-19/P/O/01802' THEN
               ERROR('You Do not have rights to release this order');

             IF ("Order Date" >= DMY2DATE(1,7,2017)) AND  (NOT ( Structure IN['PURCH_GST','PUR_FR_GST','GST+TCS'])) THEN
               BEGIN
                 ERROR('Please Choose GST Tax Structure');
               END;




            // added by Vishnu Priya for Vendor minimum order value checking on 18-12-2018
            checkminimumordervalue;
            Location_Mismatch_Not;
            // added by Vishnu Priya to check indents existed or not on 06-07-2019
            IndentExistedOrnot;
            UpdationtoIndentLines;

            PurchLine.RESET;
            PurchLine.SETRANGE(PurchLine."Document No.","No.");
            //PurchLine.SETRANGE(PurchLine.Type,PurchLine.Type::Item);
            PurchLine.SETFILTER(PurchLine.Type,'<>%1',PurchLine.Type::" ");

            IF PurchLine.FINDSET THEN
            REPEAT
              IF (PurchLine."Unit Cost (LCY)" = 0) AND (PurchLine.Sample = FALSE) THEN     //Added by Pranavi on 07-08-2015 for if item is sample then allow without unit cost
                ERROR('Enter the unit cost for '+PurchLine."No.");
              IF PurchLine."Gen. Prod. Posting Group"='' THEN      //added by Pranavi on 07-07-2015 to restrict items without Gen.Prod.posting grp
                ERROR('Please Enter General Prod. Posting Group for Item No '+PurchLine."No." +' Line No ' +FORMAT(PurchLine."Line No.") );
              IF PurchLine."Gen. Bus. Posting Group"='' THEN      //added by sujani on19-12-18 to restrict items without Gen.bus.posting grp
                ERROR('Please Enter General Bus. Posting Group for '+PurchLine."No."  +' Line No ' +FORMAT(PurchLine."Line No."));
              IF PurchLine.Make ='' THEN
                ERROR('Please Enter Make for '+PurchLine."No."  +' Line No ' +FORMAT(PurchLine."Line No."));       //added by sujani on 19-12-18 to restrict items without make
              IF PurchLine."Unit of Measure" ='' THEN
                ERROR('Please Enter Unit of Measure for '+PurchLine."No."  +' Line No ' +FORMAT(PurchLine."Line No."));       //added by sujani on 19-12-18 to restrict items uom


              item.RESET;                                   //Added by Pranavi to restrict items with PO Blocked is true on 27-07-2015
              item.SETFILTER(item."No.",PurchLine."No.");
              IF item.FINDFIRST THEN
              BEGIN
                IF item."PO Blocked" = TRUE THEN
                  ERROR('Purch Order Cannot be released beacause of Item: '+item."No."+' is blocked for PO!');
              END;                                      //End by Pranavi
              IF (Structure = 'PURCH_GST') AND ("GST Vendor Type" <> "GST Vendor Type"::Import) THEN
              BEGIN
                 IF (PurchLine."GST Group Code" = '') THEN
                   ERROR('Please enter GST GROUP CODE for Line No :: '+ FORMAT(PurchLine."Line No."))
                 ELSE IF (PurchLine."HSN/SAC Code" = '') THEN
                      ERROR('Please enter HSN/SAC Code for Line No :: '+ FORMAT(PurchLine."Line No."))

              END;
            UNTIL PurchLine.NEXT =0;

            // end by Rakesh
            // Added by Pranavi on 22-Jul-2016 for TIN No of vendor checking
            Vndr.RESET;
            Vndr.SETRANGE(Vndr."No.","Buy-from Vendor No.");
            IF Vndr.FINDFIRST THEN
              IF Vndr."Gen. Bus. Posting Group" <> 'FOREIGN' THEN
                IF (Vndr."T.I.N. No." = '') AND (Vndr."T.I.N Status" IN[Vndr."T.I.N Status"::" ",Vndr."T.I.N Status"::TINAPPLIED]) THEN
                  ERROR('Please enter T.I.N Number in Vendor Card in Tax Information Tab!\IF TIN Not Applicable update TIN Status to TIN Invalid!');
            // end by pranavi

            vendorRec.RESET;
            vendorRec.SETFILTER(vendorRec."No.","Buy-from Vendor No.");
            vendorRec.SETFILTER(vendorRec."Way bill Required",'%1',TRUE);
            IF vendorRec.FINDFIRST THEN
            BEGIN
              IF "Way bill"='' THEN
                ERROR('Please enter way bill No.');
            END;




            "G\L".GET;
            IF "G\L"."Active ERP-CF Connection" THEN
            BEGIN
              TESTFIELD(Status,Status::Open);
              TESTFIELD(Structure);
              TESTFIELD("Payment Terms Code");
              IF "Payment Terms".GET("Payment Terms Code") THEN
              BEGIN
                IF NOT "Payment Terms"."Update In Cashflow" THEN
                  ERROR('PAYMENT TERMS CODE MUST BE UPDATED IN CASH FLOW');
              END;
              IF (NOT "Calculate Tax Structure") AND (Structure<>'') THEN
                ERROR('PLEASE CALCULATE THE TAX STRUCTURE');
            END
              //Added by sundar for resolving records missing in Cashflow
            ELSE
            BEGIN
              IF UPPERCASE(USERID) IN ['EFFTRONICS\ANILKUMAR','EFFTRONICS\PRANAVI'] THEN
              BEGIN
                IF NOT CONFIRM(Text001,FALSE,"No.") THEN
                  EXIT;
              END
              ELSE
                ERROR('Cash Flow connection is not active Contact ERP Team');
            END;
              //Added by sundar for resolving records missing in Cashflow
            IF ("Order Date"=0D) OR ("Order Date">"G\L"."Allow Posting To" ) THEN
               MESSAGE('PLEASE ENTER THE ORDER DATE ');

            IF (Structure='') AND (NOT "Inclusive of All Taxes") AND ( "Order Date" > 121709D ) THEN //Rev01
                 ERROR('PLEASE ENTER THE TAX STRUCTRE & CALCULATE THE TAX STRUCTURE');

            IF NOT (( "Location Code"='R&D STR') OR ("Location Code"='CS STR') OR ("Location Code"='STR') OR ("Location Code"='SITE')OR ("Location Code"='CONSTRUCTI')) THEN
            ERROR('Location Code Must be In R&D STR,CS STR,STR,SITE');//sundar

            IF "Location Code"='R&D STR' THEN
            BEGIN
            IF (COPYSTR("Shortcut Dimension 1 Code",1,2)<>'RD') THEN
            ERROR('Please Pick R&D Dimension Code')
            END;
            IF "Location Code"='CS STR' THEN
            BEGIN
            IF (COPYSTR("Shortcut Dimension 1 Code",1,3)<>'CUS') THEN
            ERROR('Please Pick CS Dimension Code')
            END;
            IF "Location Code"='STR' THEN
            BEGIN
            IF (COPYSTR("Shortcut Dimension 1 Code",1,3)<>'PRD') THEN
            ERROR('Please Pick PRD Dimension Code')
            END;
            PurchLine.SETRANGE(PurchLine."Document No.","No.");
            PurchLine.SETFILTER(PurchLine.Quantity,'>%1',0);
            IF PurchLine.FINDSET THEN
            REPEAT
              IF PurchLine."Buy-from Vendor No."<>"Buy-from Vendor No." THEN
                ERROR('VENDOR MUST BE SAME IN PURCHASE LINES & HEADER');
            IF (PurchLine.Type=PurchLine.Type::Item) OR (PurchLine.Type=PurchLine.Type::"G/L Account") THEN
            BEGIN
              IF  (PurchLine.Type=PurchLine.Type::Item) AND (PurchLine.Make='') THEN
                  ERROR('Enter Make for Item '+ PurchLine.Description);
              IF (("Sale Order No"='') AND (PurchLine.Type=PurchLine.Type::Item)) AND ("Order Date">060109D) THEN;
             // PurchLine.TESTFIELD(PurchLine."Expected Receipt Date");

              IF PurchLine."Gen. Prod. Posting Group"='' THEN
                ERROR(' THERE IS NO "Gen. Prod. Posting Group" FOR '+PurchLine.Description);
              IF (PurchLine."Location Code"='SITE') AND ("Order Date">081109D)  THEN
              BEGIN
                IF PurchLine."Shortcut Dimension 2 Code"='' THEN
                   ERROR('Please Enter the Site Information');
            { IF ("Sale Order No"='') THEN
                //  ERROR('Please Enter the Sale Order Information');
              END
              ELSE  IF (PurchLine."Location Code"='SITE') AND ("Order Date"<110809D)   THEN
              BEGIN }
              { IF ("Sale Order No"='') THEN
                  ERROR('Please Enter the Sale Order Information');}//anil comented for closed sale orders details
              END;


            IF (PurchLine."Direct Unit Cost"=0) AND NOT(PurchLine.Sample) THEN
              ERROR('THERE IS NO COST FOR THE ITEM  '+PurchLine.Description);
              "Excepted Rcpt.Date Tracking".RESET;
              "Excepted Rcpt.Date Tracking".SETRANGE("Excepted Rcpt.Date Tracking"."Document No.",PurchLine."Document No.");
              "Excepted Rcpt.Date Tracking".SETRANGE("Excepted Rcpt.Date Tracking"."Document Line No.",PurchLine."Line No.");
            {  IF NOT ("Excepted Rcpt.Date Tracking".FINDFIRST) THEN
              BEGIN
                IF(PurchLine."Expected Receipt Date"<>PurchLine."Deviated Receipt Date")  AND ("Order Date">010609D) THEN
                ERROR('Expected Receipt Date is not equal to Deviated Receipt Date for '+PurchLine."No.");
              //MESSAGE('');
              END;   }
              IF(PurchLine.Type<>PurchLine.Type::"G/L Account") THEN
              PurchLine.TESTFIELD(PurchLine."QC Enabled");
              IF "Location Code"<>PurchLine."Location Code" THEN
              ERROR('location code not matching in both line and header');
            END;
            UNTIL PurchLine.NEXT=0;
              //comment by anil
            // MAIL CODE FOR ORDERING THE R&D INDENTS
            {
            IF (USERID<>'EFFTRONICS\CHOWDARY') AND (USERID<>'EFFTRONICS\BRAHMAIAH') AND (USERID<>'EFFTRONICS\ANILKUMAR')AND (USERID<>'SUPER') AND (USERID<>'EFFTRONICS\PRANAVI')  THEN
            ERROR('You have No Rights')
            ELSE
            BEGIN

            IF ("Location Code"='R&D STR') AND (Status=Status::Open) THEN
            BEGIN
            j:=0;
              Prev_Indent:='';
              PurchLine.RESET;
              PurchLine.SETRANGE(PurchLine."Document No.","No.");
              PurchLine.SETCURRENTKEY(PurchLine."Indent No.");
              PurchLine.SETRANGE(PurchLine."Location Code",'R&D STR');
              IF PurchLine.FINDSET THEN
              REPEAT

              IF PurchLine."Indent No."<>'' THEN
              BEGIN
               IF (Prev_Indent='') OR (Prev_Indent<>PurchLine."Indent No.") THEN
               BEGIN
                  IF j<=0 THEN
                  j:=1
                  ELSE
                  j:=j;
                  Body:='';
                  Mail_From:='';
                  Mail_To:='';
                  Subject:='';
                  attachment:='';
                  Prev_Indent:=PurchLine."Indent No.";
                  PL.RESET;
                  PL.SETRANGE(PL."Document No.",PurchLine."Document No.");
                  PL.SETRANGE(PL."Indent No.",Prev_Indent);
                  IF PL.FINDFIRST THEN
                  BEGIN
                  REPORT.RUN(50157,FALSE,FALSE,PL);
                  attachment:='\\erpserver\ErpAttachments\ErpAttachments1\p_int_details'+FORMAT(j)+'.html';
                  REPORT.SAVEASHTML(50157,attachment,FALSE,PL);
                  END;
                  INDENT_HEADER.RESET;
                  INDENT_HEADER.SETRANGE(INDENT_HEADER."No.",Prev_Indent);
                  INDENT_HEADER.SETRANGE(INDENT_HEADER."Delivery Location",'R&D STR');
                   IF INDENT_HEADER.FINDFIRST THEN
                    BEGIN
                     dateofit:=DT2DATE(INDENT_HEADER."Release Date Time");
                     noofdays:=FORMAT(TODAY-dateofit);
                     USER.RESET;
                     USER.SETRANGE(USER."User ID",USERID);
                     IF USER.FINDFIRST THEN
                      Mail_From:=USER.MailID;
                     USER.RESET;
                     USER.SETRANGE(USER."User ID",INDENT_HEADER."Person Code");
                     IF USER.FINDFIRST THEN
                       Mail_To:=USER.MailID;
                     Subject:='YOUR INDENT ('+Prev_Indent +' ) FOR "'+INDENT_HEADER."Production Order Description"+'" HAS BEEN ORDERED ';
            //         Body+=FORMAT(NEW_LINE);
                     Body+='****testing  Auto Mail Generated From ERP  ****';
            //         Mail_From:='sreenu@efftronics.com';
            //         Mail_To:='sreenu@efftronics.com';
                     IF((Mail_From<>'') AND (Mail_To<>'')) THEN
                     BEGIN
                       SMTP_MAIL.CreateMessage('PURCHASE ORDER',Mail_From,Mail_To,Subject,Body,FALSE);
                       SMTP_MAIL.AddAttachment(attachment);
                     END;
            //            SLEEP(2000);
                    j:=j+1;
                    END;
                END;
               END;
              UNTIL PurchLine.NEXT=0;
            END;
            END;
            }

            IF (ten_percent_item_Cost_high_chk) THEN
            BEGIN
            IF (UPPERCASE(USERID) IN ['EFFTRONICS\CHOWDARY','EFFTRONICS\BRAHMAIAH','EFFTRONICS\ANILKUMAR','EFFTRONICS\PRANAVI','EFFTRONICS\PKOTESWARARAO','EFFTRONICS\PADMASRI','EFFTRONICS\SPURTHI','EFFTRONICS\ANVESH','EFFTRONICS\RENUKACH'])
              OR ((UPPERCASE(USERID) IN ['EFFTRONICS\ANANDA','EFFTRONICS\NSUDHEER','EFFTRONICS\RAVIKIRAN', 'EFFTRONICS\PARDHU','EFFTRONICS\GRAVI','EFFTRONICS\SUJANI','EFFTRONICS\VISHNUPRIYA']) AND ("First Release DateTime" <> 0DT))
            THEN
                BEGIN
              // IF (ten_percent_item_Cost_high_chk) THEN
                ReleasePurchDoc.PerformManualRelease(Rec);
               END
            ELSE
                  ERROR('You have No Rights to release. Contact Purchase Dept Manager');
            "Packing Value":=0;
            //PurchLine.CALCFIELDS(PurchLine."Document Date"); // commented in the process of code review
            PurchLine.RESET;
            PurchLine.SETRANGE(PurchLine."Document No.","No.");
            PurchLine.SETFILTER(PurchLine."No.",'<>%1','');
            PurchLine.SETFILTER(PurchLine.Quantity,'>%1',0);
            IF PurchLine.FINDSET THEN
            REPEAT
            PurchLine.CALCFIELDS(PurchLine."Document Date"); // above  commented line moved here in code review
            "G\L".GET;
            IF "G\L"."Active ERP-CF Connection" AND ("Order Date">=020110D)  THEN //
            BEGIN

                "Packing Value":=0;
                Frieght_Value:=0;
                Insurance_Value:=0;
                Additional_Duty:=0;
                Service_Amount:=0;
                Line_Amount:=0;
                Unit_Cost:=0;
                StructureOrderLineDetails.RESET;
                StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails.Type,StructureOrderLineDetails.Type::Purchase);
                StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails."Document No.",PurchLine."Document No.");
                StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails."Line No.",PurchLine."Line No.");
                StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails.Type,StructureOrderLineDetails.Type::Purchase);
                IF StructureOrderLineDetails.FINDSET THEN
                REPEAT
                  IF ((StructureOrderLineDetails."Tax/Charge Group"='PACKING')  OR
                     (StructureOrderLineDetails."Tax/Charge Group"='FORWARDING') )   THEN
                  BEGIN

                      "Packing Value"+=StructureOrderLineDetails."Amount (LCY)";
                  END ELSE
                  IF StructureOrderLineDetails."Tax/Charge Group"='FREIGHT' THEN
                  BEGIN
                    Frieght_Value+=StructureOrderLineDetails."Amount (LCY)";
                  END ELSE
                  IF StructureOrderLineDetails."Tax/Charge Group"='CUSTOMS DU' THEN
                  BEGIN
                    Frieght_Value+=StructureOrderLineDetails."Amount (LCY)";
                  END ELSE

                  IF StructureOrderLineDetails."Tax/Charge Group"='INSURANCE' THEN
                  BEGIN
                    Insurance_Value+=StructureOrderLineDetails."Amount (LCY)";
                  END ELSE
                  IF StructureOrderLineDetails."Tax/Charge Group"='ADD.DUTY' THEN
                    Additional_Duty+=StructureOrderLineDetails."Amount (LCY)"
                  ELSE IF StructureOrderLineDetails."Tax/Charge Type"=StructureOrderLineDetails."Tax/Charge Type"::"Service Tax" THEN
                    Service_Amount+=StructureOrderLineDetails."Amount (LCY)";

                UNTIL StructureOrderLineDetails.NEXT=0;
             // END;
              IF PurchLine."Currency Code"='' THEN
              BEGIN
                Unit_Cost:=PurchLine."Direct Unit Cost";
                Line_Amount:=PurchLine.Quantity*PurchLine."Direct Unit Cost";
                tds_amt:= PurchLine."TDS Amount"; // added by sujani on 22-Jan-2020 for Foerign vendors TDS Deduction in cashflow
              END ELSE
              BEGIN
                Unit_Cost:=PurchLine."Direct Unit Cost"/"Currency Factor";
                Line_Amount:=(PurchLine.Quantity*PurchLine."Direct Unit Cost")/"Currency Factor";
                tds_amt:= PurchLine."TDS Amount"/"Currency Factor"; // added by sujani on 22-Jan-2020 for Foerign vendors TDS Deduction in cashflow


              END;
              IF  PurchLine."Line Discount Amount">0 THEN
                 Additional_Duty-=PurchLine."Line Discount Amount";
              IF (PurchLine."Frieght Charges">0) THEN
              BEGIN
                IF PurchLine."Currency Code"='' THEN
                  Frieght_Value:=PurchLine."Frieght Charges"
                ELSE
                  Frieght_Value:=PurchLine."Frieght Charges"/"Currency Factor";
              END;
              IF ((Structure = 'PURCH_GST' )OR (Structure = 'PUR_FR_GST') OR  (Structure = 'GST+TCS')) THEN
              BEGIN
                  IF "Do not Consider GST" = TRUE THEN
                    GST_AMOUNT:=0
                  ELSE
                    GST_AMOUNT:=PurchLine."Total GST Amount";
                  END
              //  GST_AMOUNT:=PurchLine."Total GST Amount"
              ELSE  IF (PurchLine."Tax Area Code"='PURH VAT') THEN
                VAT_AMOUNT:=PurchLine."Tax Amount"
              ELSE
               CST_AMOUNT:=PurchLine."Tax Amount";
              IF PurchLine."Location Code"='CS STR' THEN
                 Dept:='CS'
              ELSE
                Dept:='NORMAL';
              IF PurchLine."TDS Amount" >0 THEN
              BEGIN
                  //Line_Amount := Line_Amount - PurchLine."TDS Amount" ;
                  Line_Amount := Line_Amount - tds_amt ; // added by sujani on 22-Jan-2020 for Foerign vendors TDS Deduction in cashflow
                  Unit_Cost := Unit_Cost - ( PurchLine."TDS Amount" /PurchLine.Quantity);
              END;
              IF (PurchLine.Sample=FALSE) THEN
              CashFlowConnection.ExecInOracle('insert into Purchase_line'+
                                              '(PURCHASE_ID,ORDERNO,ITEMNO,VENDORID,UNIT_COST,UNITS_REQ,DEVIATED_DATE,ORDER_RELEASE_DATE,'+
                                              ' VAT,EXCISE,CST,PAYMENT_TERMS_CODE,ORDER_VALUE,PACKING_COST,ORDER_LINE_NO,SERVICE_AMOUNT,'+
                                              'INSURANCE_VALUE,FRIEGHT_CHARGES,ADD_DUTY,LOCATION_CODE,DEPT_WISE,ACTINACT)'+
                                              'values (seq_Purchase_ID.nextval,'''+PurchLine."Document No."+''', '''+PurchLine."No."+''','''+
                                              Rec."Buy-from Vendor No."+''','''+
                                              CommaRemoval(FORMAT(ROUND(Unit_Cost,0.001))) +''','''+
                                              CommaRemoval(FORMAT(PurchLine.Quantity))+''','''+
                                              FORMAT(PurchLine."Deviated Receipt Date",0,'<Day>-<Month Text,3>-<Year4>')+''','''+
                                              FORMAT(DT2DATE("Release Date Time"),0,'<Day>-<Month Text,3>-<Year4>')+''','''+
                                             // CommaRemoval(FORMAT(ROUND(VAT_AMOUNT,0.01)))+''','''+
                                              CommaRemoval(FORMAT(ROUND(GST_AMOUNT,0.01)))+''','''+
                                              CommaRemoval(FORMAT(ROUND(PurchLine."Excise Amount",0.01)))+''','''+
                                              CommaRemoval(FORMAT(ROUND(CST_AMOUNT,0.01)))+''','''+
                                              FORMAT("Payment Terms Code")+''','''+
                                              CommaRemoval(FORMAT(ROUND(Line_Amount,0.001)))+''','''+
                                              CommaRemoval(FORMAT(ROUND("Packing Value",0.001)))+''','''+
                                              FORMAT(PurchLine."Line No.")+''','''+
                                              CommaRemoval(FORMAT(ROUND(Service_Amount,0.01)))+''','''+
                                              CommaRemoval(FORMAT(ROUND(Insurance_Value,0.01)))+''','''+
                                              CommaRemoval(FORMAT(ROUND(Frieght_Value,0.01)))+''','''+
                                              CommaRemoval(FORMAT(ROUND(Additional_Duty,0.01)))+''','''+
                                              PurchLine."Location Code"+''','''+
                                              Dept +''',1)');
                                            //  MESSAGE(FORMAT(ROUND(Line_Amount,0.001)));
            END;
            UNTIL PurchLine.NEXT=0;
            END
            //Mails;
            */
        //end;


        //Unsupported feature: CodeModification on "Reopen(Action 138).OnAction". Please convert manually.

        //trigger OnAction();
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
            /*
            ReleasePurchDoc.PerformManualReopen(Rec);
            */
        //end;
        //>>>> MODIFIED CODE:
        //begin
            /*
            IF Rec."No." = 'EFF/18-19/P/O/01802' THEN
              ERROR('You Do not have rights to reopen this order');
            IF NOT(UPPERCASE(USERID) IN ['EFFTRONICS\CHOWDARY','EFFTRONICS\PADMASRI','EFFTRONICS\ANILKUMAR','EFFTRONICS\GRAVI','EFFTRONICS\PKOTESWARARAO','EFFTRONICS\BRAHMAIAH','EFFTRONICS\SPURTHI','EFFTRONICS\ANVESH','EFFTRONICS\RENUKACH'
              , 'EFFTRONICS\ANANDA','EFFTRONICS\NSUDHEER','EFFTRONICS\RAVIKIRAN', 'EFFTRONICS\PARDHU','EFFTRONICS\SUJANI','EFFTRONICS\VISHNUPRIYA','EFFTRONICS\RRAHUL','EFFTRONICS\B2BOTS','EFFTRONICS\LAKSHMIKANTH']) THEN
            ERROR('You have No Rights to reopen a Released order. Contact Purchase Manager.')
            ELSE
            ReleasePurchDoc.PerformManualReopen(Rec);
            "G\L".GET;
            IF "G\L".FINDFIRST THEN
            BEGIN
              "Calculate Tax Structure":=FALSE;
              MODIFY;
              //cashflow integration
              CashFlowConnection.ExecInOracle('Update Purchase_line Set Actinact=0 Where   OrderNo='''+"No."+'''');
            END;
            */
        //end;


        //Unsupported feature: CodeModification on "Action 1500041.OnAction". Please convert manually.

        //trigger OnAction();
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
            /*
            PurchLine.CalculateStructures(Rec);
            PurchLine.AdjustStructureAmounts(Rec);
            PurchLine.UpdatePurchLines(Rec);
            */
        //end;
        //>>>> MODIFIED CODE:
        //begin
            /*
            IF (Structure = 'PURCH_GST') THEN
            BEGIN
              IF ("GST Vendor Type" = "GST Vendor Type"::" ") THEN
                  ERROR('GST Vendor Type Not Defined. Please check Vendor GST Details');
              IF ("GST Vendor Type" <> "GST Vendor Type"::Import) THEN
              BEGIN
                PL.RESET;
                PL.SETFILTER(PL."Document No.", "No.");
                PL.SETFILTER("Qty. to Receive",'>%1',0);
                IF PL.FINDSET THEN
                REPEAT
                  IF PL."No." <> '' THEN
                  BEGIN
                    IF (PL."HSN/SAC Code" = '')  AND  (UPPERCASE(USERID) <> 'EFFTRONICS\VIJAYA')  THEN
                        ERROR('Please Enter HSN/SAC Details for Line No :: '+ FORMAT(PL."Line No."));
                    IF (PL."GST Group Code" = '')  AND  (UPPERCASE(USERID) <> 'EFFTRONICS\VIJAYA') THEN
                      ERROR('Please Enter GST Group Code Details for Line No :: '+ FORMAT(PL."Line No."));
                  END;
                UNTIL PL.NEXT = 0;
              END;
            END;
            Location_Mismatch_Not;
            // added by vishnu priya for Vendor Minimum Order Value Checking on 18-12-2018
            checkminimumordervalue;

            "G\L".GET;
            IF "G\L"."Active ERP-CF Connection" THEN
            BEGIN
              TESTFIELD(Status,Status::Open);
              TESTFIELD(Structure);
              TESTFIELD("Order Date");
              "Calculate Tax Structure":=TRUE;
              MODIFY;
            END;

            #1..3
            */
        //end;


        //Unsupported feature: CodeModification on "Post(Action 79).OnAction". Please convert manually.

        //trigger OnAction();
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
            /*
            Post(CODEUNIT::"Purch.-Post (Yes/No)");
            */
        //end;
        //>>>> MODIFIED CODE:
        //begin
            /*
            TESTFIELD(Status,Status::Released);
            TESTFIELD(Structure);
            TESTFIELD("Payment Terms Code");
            Post(CODEUNIT::"Purch.-Post (Yes/No)");
            */
        //end;


        //Unsupported feature: CodeModification on "Action 82.OnAction". Please convert manually.

        //trigger OnAction();
        //Parameters and return type have not been exported.
        //>>>> ORIGINAL CODE:
        //begin
            /*
            DocPrint.PrintPurchHeader(Rec);
            */
        //end;
        //>>>> MODIFIED CODE:
        //begin
            /*
            //DocPrint.PrintPurchHeader(Rec);
             PurchaseHeader.SETRANGE(PurchaseHeader."No.","No.");
             REPORT.RUN(50058,TRUE,FALSE,PurchaseHeader);
            */
        //end;
        addfirst("Action 13")
        {
            separator(Action1102152027)
            {
            }
            action("Short Close Order")
            {
                Caption = 'Short Close Order';
                Image = CloseDocument;

                trigger OnAction();
                var
                    OrderStatusValue : Text[50];
                    Text050 : Label 'Do you want to Short Close the Order No. %1';
                begin
                    IF NOT(USERID IN['EFFTRONICS\VISHNUPRIYA','EFFTRONICS\ANILKUMAR','EFFTRONICS\ANVESH','EFFTRONICS\SPURTHI']) THEN    //Added by Pranavi on 03-Dec-2015
                      ERROR('You Do Not Have Rights to Short Close the Order!');
                    IF CONFIRM(Text050,FALSE,"No.") THEN BEGIN
                      OrderStatusValue:='Close';
                      CancelCloseOrder(OrderStatusValue,Rec);
                      CurrPage.UPDATE(FALSE);
                    END;
                end;
            }
            action("Cancel Order")
            {
                Caption = 'Cancel Order';
                Image = Closed;

                trigger OnAction();
                var
                    OrderStatusValue : Text[50];
                    Text051 : Label 'Do you want to Cancel the Order No. %1';
                begin
                    IF NOT(USERID IN['EFFTRONICS\PRANAVI','EFFTRONICS\ANILKUMAR','EFFTRONICS\ANVESH','EFFTRONICS\SPURTHI']) THEN    //Added by Pranavi on 03-Dec-2015
                      ERROR('You Do Not Have Rights to Cancel Order!');
                    IF CONFIRM(Text051,FALSE,"No.") THEN BEGIN
                      OrderStatusValue:='Cancel';
                      CancelCloseOrder(OrderStatusValue,Rec);
                      CurrPage.UPDATE(FALSE);
                    END;
                end;
            }
        }
        addafter(Reopen)
        {
            separator(Action1102152013)
            {
            }
            action("MSPT Order Details")
            {
                Caption = 'MSPT Order Details';
                Image = ViewDetails;
                RunObject = Page "MSPT Order Details";
                                RunPageLink = Type=CONST(Purchase),Document Type=FIELD(Document Type),Document No.=FIELD(No.);
            }
            action("Send For QC Approval")
            {

                trigger OnAction();
                var
                    Body : Text;
                    Mail_From : Text[250];
                    Mail_To : Text[250];
                    Mail : Codeunit Mail;
                    Subject : Text[250];
                    SMTP_MAIL : Codeunit "SMTP Mail";
                    AuthorizedID : Text[50];
                    ReqUserGRec : Record User;
                    AuthUserGRec : Record User;
                    Auth_User : Text[50];
                    Req_User : Text[50];
                    Req_Person_Id : Code[10];
                    SH : Record "Sales Header";
                    customername : Text[100];
                    PurchaseHeader : Record "Purchase Header";
                    Attachment1 : Text[50];
                begin
                    // Added by Pranavi on 03-Dec-2016 for B-Out Material QC Approval
                    IF "Sale Order No" = '' THEN
                      ERROR('Sale Order No. should not be null!');
                    IF QA_Auth_Status = QA_Auth_Status::Authorized THEN
                      ERROR('Already authorized by the QA!')
                    ELSE IF QA_Auth_Status = QA_Auth_Status::"Sent For Auth" THEN
                      ERROR('Already sent for Authorization!');
                    SH.RESET;
                    SH.SETRANGE(SH."No.","Sale Order No");
                    SH.SETRANGE(SH."Document Type",SH."Document Type"::Order);
                    IF SH.FINDFIRST THEN
                      customername := SH."Sell-to Customer Name";

                    Body:='';
                    Mail_From:='';
                    Mail_To:='';
                    Req_Person_Id:='';
                    ReqUserGRec.RESET;
                    ReqUserGRec.SETRANGE(ReqUserGRec."User Name",USERID);
                    IF ReqUserGRec.FINDFIRST THEN
                    BEGIN
                      Req_User:=ReqUserGRec."User Name";
                      Req_Person_Id := ReqUserGRec.EmployeeID;
                      IF ReqUserGRec.MailID <> '' THEN
                        Mail_From := ReqUserGRec.MailID
                      ELSE Mail_From := 'erp@efftronics.com';
                    END ELSE Mail_From := 'erp@efftronics.com';
                    Req_User := COPYSTR(USERID,12,STRLEN(USERID));
                    Auth_User := 'BHARAT V';
                    Mail_To := 'qainward@efftronics.com,erp@efftronics.com,sysadmin@efftronics.com';
                    //Mail_To := 'pranavi@efftronics.com';
                    Subject:='ERP-QA Conformation Required for purchase of Bought Out Items in P.O.: '+"No."+' for ('+customername+'--'+"Sale Order No"+')';
                    Body:='<html><head><style> divone{background-color: white; width: 700px; padding: 20px; border-style:solid ; border-color:#666699;  margin: 20px;} </style></head>';
                    Body+='<body><div style="border-color:#666699;  margin: 20px; border-width:15px;   border-style:solid; padding: 20px; width: 600px;"><label><font size="6">P.O. Details</font></label>';
                    Body+='<hr style=solid; color= #3333CC>';
                    Body+='<table border="1" style="border-collapse:collapse; width:100%; font-size:10pt;">';
                    Body+='<tr><td>Purchase Order</td><td>'+"No."+'</td></tr><br>';
                    Body+='<tr><td>Vendor</td><td>'+"Buy-from Vendor Name"+'</td></tr><br>';
                    Body+='<tr><td>Sales Order</td><td>'+"Sale Order No"+'</td></tr><br>';
                    Body+='<tr><td>Customer</td><td>'+customername+'</td></tr><br>';
                    Body+='<tr><td bgcolor="green">';
                    Body+='<a Href="http://app.efftronics.org:8567/erp_reports/Purch_BOI_QA_Auth.aspx?PO_NO='+FORMAT("No.");
                    Body+='&AUTHPERSON='+FORMAT(Auth_User);
                    Body+='&REQPERSON='+FORMAT(Req_User);
                    Body+='&REQPERSONMAIL='+Mail_From;
                    Body+='&REQID='+Req_Person_Id;
                    Body+='&SALE_ORDER_NO='+"Sale Order No";
                    Body+='&CUSTOMER='+customername;
                    Body+='&AUTHSTATUS=1"target="_blank">';
                    Body+='<font face="arial" color="#ffffff">ACCEPT</font></a>';

                    Body+='</td><td bgcolor="red">';
                    Body+='<a Href="http://app.efftronics.org:8567/erp_reports/Purch_BOI_QA_Auth.aspx?PO_NO='+FORMAT("No.");
                    Body+='&AUTHPERSON='+FORMAT(Auth_User);
                    Body+='&REQPERSON='+FORMAT(Req_User);
                    Body+='&REQPERSONMAIL='+Mail_From;
                    Body+='&REQID='+Req_Person_Id;
                    Body+='&SALE_ORDER_NO='+"Sale Order No";
                    Body+='&CUSTOMER='+customername;
                    Body+='&AUTHSTATUS=0"target="_blank">';
                    Body+='<font face="arial" color="#ffffff">REJECT</font></a></td></tr>';

                    Body+='</table><br>';
                    Body+='<p align = "left"></b>Please go through the attached P.O.</b></P>';
                    Body+='<br><p align = "center">:: Note: Auto Generated mail from ERP</b> :: </b></P></div></body></html>';
                    SMTP_MAIL.CreateMessage('ERP',Mail_From,Mail_To,Subject,Body,TRUE);

                    PurchaseHeader.SETRANGE(PurchaseHeader."No.","No.");
                    REPORT.RUN(50058,FALSE,FALSE,PurchaseHeader);
                    REPORT.SAVEASPDF(50058,'\\erpserver\ERPattachments\podetails.PDF',PurchaseHeader);
                    Attachment1:='\\erpserver\ERPattachments\podetails.PDF';
                    SMTP_MAIL.AddAttachment(Attachment1,''); //EFFUPG


                    SMTP_MAIL.Send;

                    QA_Auth_Status:= QA_Auth_Status::"Sent For Auth";
                    QA_Auth_Date := TODAY;
                    MODIFY;
                end;
            }
        }
        addafter("Action 195")
        {
            action("Send Request for Release")
            {
                Caption = 'Send Request for Release';
                Image = SendApprovalRequest;
                ToolTip = 'Send Request for Release';

                trigger OnAction();
                begin
                    
                    "G\L".GET;
                    
                    IF "G\L"."Active ERP-CF Connection" THEN
                    BEGIN
                      TESTFIELD(Status,Status::Open);
                      TESTFIELD("Payment Terms Code");
                      IF "Payment Terms".GET("Payment Terms Code") THEN
                      BEGIN
                        IF NOT "Payment Terms"."Update In Cashflow" THEN
                          ERROR('PAYMENT TERMS CODE MUST BE UPDATED IN CASH FLOW');
                      END;
                      IF (NOT "Calculate Tax Structure") AND (Structure<>'') THEN
                         ERROR('PLEASE CALCULATE THE TAX STRUCTURE');
                    END;
                    IF "Order Date"=0D THEN
                       MESSAGE('PLEASE ENTER THE ORDER DATE ');
                    
                    IF (Structure='') AND (NOT "Inclusive of All Taxes") AND ( "Order Date"> 121709D) THEN //Rev01
                         ERROR('PLEASE ENTER THE TAX STRUCTRE & CALCULATE THE TAX STRUCTURE');
                    
                    IF ("Location Code"='R&D STR') AND  (COPYSTR("Shortcut Dimension 1 Code",1,2)<>'RD') THEN
                          ERROR('Please Pick R&D Dimension Code');
                    
                    IF ("Location Code"='CS STR') AND (COPYSTR("Shortcut Dimension 1 Code",1,3)<>'CUS')  THEN
                       ERROR('Please Pick CS Dimension Code');
                    
                    IF ("Location Code"='STR') AND (COPYSTR("Shortcut Dimension 1 Code",1,3)<>'PRD')  THEN
                       ERROR('Please Pick PRD Dimension Code');
                    
                    PurchLine.SETRANGE(PurchLine."Document No.","No.");
                    PurchLine.SETFILTER(PurchLine.Quantity,'>%1',0);
                    IF PurchLine.FINDSET THEN
                    REPEAT
                      IF PurchLine."Buy-from Vendor No."<>"Buy-from Vendor No." THEN
                        ERROR('VENDOR MUST BE SAME IN PURCHASE LINES & HEADER');
                      IF (PurchLine.Type=PurchLine.Type::Item) OR (PurchLine.Type=PurchLine.Type::"G/L Account") THEN
                      BEGIN
                        IF (("Sale Order No"='') AND (PurchLine.Type=PurchLine.Type::Item)) AND ("Order Date">060109D) THEN
                        BEGIN
                          IF (PurchLine."Indent No."='') AND  (PurchLine."Qty. to Receive">0) THEN
                             ERROR(' THERE IS NO INDENT FOR THE ITEM  '+PurchLine.Description);
                        END;
                        PurchLine.TESTFIELD(PurchLine."Expected Receipt Date");
                    
                        IF PurchLine."Gen. Prod. Posting Group"='' THEN
                          ERROR(' THERE IS NO "Gen. Prod. Posting Group" FOR '+PurchLine.Description);
                        IF (PurchLine."Location Code"='SITE') AND ("Order Date">081109D)  THEN
                        BEGIN
                          IF PurchLine."Shortcut Dimension 2 Code"='' THEN
                             ERROR('Please Enter the Site Information');
                          IF ("Sale Order No"='') THEN
                             ERROR('Please Enter the Sale Order Information');
                        END ELSE  IF (PurchLine."Location Code"='SITE') AND ("Order Date"<081109D)   THEN
                        BEGIN
                          IF ("Sale Order No"='') THEN
                             ERROR('Please Enter the Sale Order Information');
                        END;
                    
                        IF (PurchLine."Direct Unit Cost"=0) AND NOT(PurchLine.Sample) THEN
                           ERROR('THERE IS NO COST FOR THE ITEM  '+PurchLine.Description);
                    
                        IF(PurchLine.Type<>PurchLine.Type::"G/L Account") THEN
                           PurchLine.TESTFIELD(PurchLine."QC Enabled");
                    
                        IF "Location Code"<>PurchLine."Location Code" THEN
                           ERROR('location code not matching in both line and header');
                      END;
                    UNTIL PurchLine.NEXT=0;
                    
                      TESTFIELD(Status,Status::Open);
                      USER.SETRANGE(USER."User Name",USERID);//Rev01
                      IF USER.FIND ('-') THEN
                      BEGIN
                        Body:='';
                        Subject:='';
                        attachment:='';
                        FileDirectory:='';
                        FileName:='';
                    
                        Subject:=USER."Full Name"+' Requesting to Release the Purchase Order '+"No."; //Rev01
                        Body+='<body><strong><form><table style="WIDTH:500px; HEIGHT: 20px; "';
                        Body+='border="1" align="center">';
                       // Body+='<tr><td align="center" ><img src="http://eff-cpu-178/pur%20Auth/Default.aspx?"  /></TD></TR>';
                        Body+='<tr><td>PURCHASE ORDER NO. :</td><td>'+"No.";
                        Body+='<tr><td>VENDOR :</td><td>'+"Buy-from Vendor Name";
                        Body+='<tr><td>ORDER VALUE :</td><td>'+FORMAT(Order_Value("No."));
                        Body+='<tr><td bgcolor=#99FF66 color=#FFFFFF  align="center" ><a href="';
                      // Body+='http://localhost:8080/Purchase/Default.aspx?';
                        Body+='http://eff-cpu-178/pur%20auth/Default.aspx?';
                        Body+='val1='+FORMAT(USERID);
                        Body+='&val2='+FORMAT("No.");
                        Body+='&val3=1';
                        Body+='&val4=Chowdary@efftronics.com';
                        Body+='&val5='+USER.MailID;
                        Body+='&val6=Release';
                        Body+='&val7='+USER."Full Name"; //Rev01
                        Body+='&val8='+"Buy-from Vendor Name";
                        Body+='&val9='+FORMAT(Order_Value("No."));
                        Body+='" target="_blank"><b>Accepted</b></a></td>';
                        Body+='<td bgcolor=#FF3300 color=#FFFFFF  align="center" ><a href="';
                       // Body+='http://localhost:8080/Purchase/Default.aspx?';
                       Body+='http://eff-cpu-178/pur%20Auth/Default.aspx?';
                        Body+='val1='+FORMAT(USERID);
                        Body+='&val2='+FORMAT("No.");
                        Body+='&val3=0';
                        Body+='&val4=Chowdary@efftronics.com';
                        Body+='&val5='+USER.MailID;
                        Body+='&val6=Release';
                        Body+='&val7='+USER."Full Name"; //Rev01
                        Body+='&val8='+"Buy-from Vendor Name";
                        Body+='&val9='+FORMAT(Order_Value("No."));
                        Body+='" target="_blank"><b>Rejected</b></a></td>';
                        Body+='</table></form></font></strong></body>';
                      /*
                        IF ISCLEAR(BullZipPDF) THEN
                        CREATE(BullZipPDF);
                        FileDirectory := '\\eff-cpu-222\erp\';
                        Window.OPEN('processing  Order ######################1##');
                        Window.UPDATE(1,"No.");
                        filname:=COPYSTR("No.",15,4);
                        filesub:=COPYSTR("No.",5,5);
                        FileName :='Purchase Order'+filesub+'-'+filname+ '.pdf';
                        BullZipPDF.Init;
                        BullZipPDF.LoadSettings;
                        RunOnceFile := BullZipPDF.GetSettingsFileName(TRUE);
                        BullZipPDF.SetValue('Output',FileDirectory+FileName);
                        BullZipPDF.SetValue('Showsettings', 'never');
                        BullZipPDF.SetValue('ShowPDF', 'no');
                        BullZipPDF.SetValue('ShowProgress', 'no');
                        BullZipPDF.SetValue('ShowProgressFinished', 'no');
                        BullZipPDF.SetValue('SuppressErrors', 'yes');
                        BullZipPDF.SetValue('ConfirmOverwrite', 'no');
                        BullZipPDF.WriteSettings(TRUE);
                        PurchaseHeader.SETRANGE(PurchaseHeader."No.","No.");
                        REPORT.RUNMODAL(50058,FALSE,FALSE,PurchaseHeader);   */
                    
                        TimeOut := 0;
                        WHILE EXISTS(RunOnceFile) AND (TimeOut < 10) DO BEGIN
                        SLEEP(2000);
                        TimeOut := TimeOut + 1;
                      END;
                      Window.CLOSE;
                      attachment:=FileDirectory+FileName;
                    
                      Mail.CreateMessage(USER."Full Name",USER.MailID,'chowdary@efftronics.com',Subject,Body,TRUE);//Rev01
                     // Mail.CreateMessage(USER.Name,USER.MailID,'santhoshk@efftronics.com',Subject,Body,TRUE);
                      Mail.AddAttachment(attachment,''); //EFFUPG
                      Mail.Send;
                    END;

                end;
            }
            action("Send Request for Reopen")
            {
                Caption = 'Send Request for Reopen';
                Image = ReopenCancelled;

                trigger OnAction();
                begin
                      TESTFIELD(Status,Status::Released);
                      USER.SETRANGE(USER."User Name",USERID);  //Rev01
                      IF USER.FIND ('-') THEN
                      BEGIN
                        Body:='';
                        Subject:='';
                        attachment:='';
                        FileDirectory:='';
                        FileName:='';
                    
                        Subject:=USER."Full Name"+' Requesting to Reopen the Purchase Order '+"No.";  //Rev01
                        Body+='<body><strong><form><table style="WIDTH:500px; HEIGHT: 20px; "';
                        Body+='border="1" align="center">';
                        Reason_window.OPEN(T1);
                        Reason_window.INPUT(1,Reason);
                        Reason_window.CLOSE;
                        Body+='<tr><td><b>PURCHASE ORDER NO. :</b></td><td>'+"No.";
                        Body+='<tr><td><b>VENDOR :</b></td><td>'+"Buy-from Vendor Name";
                        Body+='<tr><td><b>REASON :</b></td><td>'+Reason;
                        Body+='<tr><td bgcolor=#99FF66 color=#FFFFFF  align="center" colspan="2"><a href=';
                       // Body+='"http://localhost:8080/Purchase/Default.aspx?';
                        Body+='"http://eff-cpu-178/pur%20Auth//Default.aspx?';
                        Body+='val1='+FORMAT(USERID);
                        Body+='&val2='+FORMAT("No.");
                        Body+='&val3=0';
                        Body+='&val4=Chowdary@efftronics.com';
                        Body+='&val5='+USER.MailID;
                        Body+='&val6=Open';
                        Body+='&val7='+USER."Full Name";  //Rev01
                        Body+='&val8='+"Buy-from Vendor Name";
                        Body+='&val9='+FORMAT(Order_Value("No."));
                    
                        Body+='" target="_blank"><b>Open</b></a></td>';
                        Body+='</table></form></font></strong></body>';
                    
                      /*  IF ISCLEAR(BullZipPDF) THEN
                        CREATE(BullZipPDF);
                        FileDirectory := '\\eff-cpu-222\erp\';
                        Window.OPEN('processing  Order ######################1##');
                        Window.UPDATE(1,"No.");
                        filname:=COPYSTR("No.",15,4);
                        filesub:=COPYSTR("No.",5,5);
                        FileName :='Purchase Order'+filesub+'-'+filname+ '.pdf';
                        BullZipPDF.Init;
                        BullZipPDF.LoadSettings;
                        RunOnceFile := BullZipPDF.GetSettingsFileName(TRUE);
                        BullZipPDF.SetValue('Output',FileDirectory+FileName);
                        BullZipPDF.SetValue('Showsettings', 'never');
                        BullZipPDF.SetValue('ShowPDF', 'no');
                        BullZipPDF.SetValue('ShowProgress', 'no');
                        BullZipPDF.SetValue('ShowProgressFinished', 'no');
                        BullZipPDF.SetValue('SuppressErrors', 'yes');
                        BullZipPDF.SetValue('ConfirmOverwrite', 'no');
                        BullZipPDF.WriteSettings(TRUE);
                        PurchaseHeader.SETRANGE(PurchaseHeader."No.","No.");
                        REPORT.RUNMODAL(50058,FALSE,FALSE,PurchaseHeader);  */
                    
                        TimeOut := 0;
                        WHILE EXISTS(RunOnceFile) AND (TimeOut < 10) DO BEGIN
                        SLEEP(2000);
                        TimeOut := TimeOut + 1;
                      END;
                      Window.CLOSE;
                      attachment:=FileDirectory+FileName;
                     // Mail.CreateMessage(USER.Name,USER.MailID,'chowdary@efftronics.com',Subject,Body,TRUE);
                      Mail.CreateMessage(USER."Full Name",USER.MailID,'ERP@efftronics.com',Subject,Body,TRUE); //Rev01
                      Mail.AddAttachment(attachment,''); //EFFUPG
                      Mail.Send;
                    
                    
                    END;

                end;
            }
        }
        addafter("Action 74")
        {
            action("Update Customs Value in Flow")
            {
                Caption = 'Update Customs Value in Flow';
                Image = CalculatePlan;
                ToolTip = 'Update Customs Value in Flow';

                trigger OnAction();
                begin
                    "G\L".GET;
                    IF "G\L"."Active ERP-CF Connection" THEN
                    BEGIN
                      IF (Structure='FORIEGN')THEN
                      BEGIN
                       // PurchLine.CALCFIELDS(PurchLine."Document Date"); commnted in Code Review
                        PurchLine.RESET;
                        PurchLine.SETRANGE(PurchLine."Document No.","No.");
                        IF PurchLine.FINDSET THEN
                        REPEAT
                          PurchLine.CALCFIELDS(PurchLine."Document Date");//above commented  code moved here in code review
                          IF PurchLine."Customs Duty Value">0 THEN
                          BEGIN
                            PurchLine.TESTFIELD(PurchLine."Customs Duty Paid to");
                            PurchLine.TESTFIELD(PurchLine."Customs To be Paid on");
                            CashFlowConnection.ExecInOracle('insert into Purchase_line'+
                                                          '(PURCHASE_ID,ORDERNO,ITEMNO,VENDORID,DEVIATED_DATE,ORDER_RELEASE_DATE,'+
                                                          'ORDER_VALUE,ORDER_LINE_NO,PAYMENT_TERMS_CODE,ACTINACT)'+
                                                         'values (seq_Purchase_ID.nextval,'''+PurchLine."Document No."+''', '''+PurchLine."No."+
                    ''','''+
                                                           PurchLine."Customs Duty Paid to"+''','''+
                                                           FORMAT(PurchLine."Customs To be Paid on",0,'<Day>-<Month Text,3>-<Year4>')+''','''+
                                                          FORMAT("Order Date",0,'<Day>-<Month Text,3>-<Year4>')+''','''+
                                                          CommaRemoval(FORMAT(ROUND(PurchLine."Customs Duty Value",0.001)))+''','''
                                                          +FORMAT(PurchLine."Line No.")+''',100,1)');
                          END;
                        UNTIL PurchLine.NEXT=0;
                      END;
                    END;
                end;
            }
            action("Print & Send Mail to supplier")
            {
                Caption = 'Print & Send Mail to supplier';
                Image = SendMail;
                Promoted = true;
                PromotedCategory = Process;

                trigger OnAction();
                var
                    Item : Record Item;
                    DescriptionString : Text[100];
                begin
                    // Added by Rakesh to send auto mail from Purchase Order on 23-Sep-14
                    IF (USERID IN ['EFFTRONICS\NSUDHEER','EFFTRONICS\CHOWDARY','EFFTRONICS\BRAHMAIAH','EFFTRONICS\RENUKACH','EFFTRONICS\ANANDA','EFFTRONICS\PARDHU','EFFTRONICS\ANILKUMAR',
                        'EFFTRONICS\GRAVI','EFFTRONICS\ANVESH','EFFTRONICS\SPURTHI','EFFTRONICS\RAVIKIRAN','EFFTRONICS\SUJANI','EFFTRONICS\VISHNUPRIYA','EFFTRONICS\PADMASRI','EFFTRONICS\PKOTESWARARAO']) AND (Status=Status::Released) THEN
                    BEGIN
                      no_atch_items :='';
                      PurchLine.RESET();
                      PurchLine.SETRANGE("Document No.","No.");
                      IF PurchLine.FINDSET THEN
                        REPEAT
                          BEGIN
                            MECH_ITEM := '';
                            IF Item.GET(PurchLine."No.") THEN
                            BEGIN
                               IF (Item."Item Category Code" = 'MECH') AND (NOT (Item."Product Group Code"  IN ['SHEET','SCREW','NUT','WASHER','BOLT','SHT','GENERAL','SPACER','HING','CLAMP','STUD','LWASHER'])) THEN
                                    MECH_ITEM := 'MECH'
                            END;
                            //MECH_ITEM := COPYSTR(PurchLine."No.",1,4);
                            MECH_ITEM_NO := PurchLine."No.";
                            IF MECH_ITEM = 'MECH' THEN
                              BEGIN
                                Attachements_Table.RESET();
                                Attachements_Table.SETRANGE("Document No.",MECH_ITEM_NO);
                                Attachements_Table.SETRANGE("Attachment Status",TRUE);
                                  IF Attachements_Table.FINDSET THEN
                                     BEGIN
                                       no_atch_items:='';
                                       IF Attachements_Table."Attachment Status"=FALSE THEN
                                        no_atch_items := no_atch_items +Attachements_Table."Document No."+'-'+PurchLine.Description+'<br/>'
                                     END
                                      ELSE
                                        //no_atch_items:= no_atch_items + PurchLine."No." +'-'+Attachements_Table.Description+'<br/>';
                                        no_atch_items:= no_atch_items + PurchLine."No." +'-'+PurchLine.Description+'<br/>';
                    
                    
                              END;
                          END;
                      UNTIL PurchLine.NEXT = 0;
                    
                      VENDOR.RESET;
                      VENDOR.SETRANGE(VENDOR."No.","Buy-from Vendor No.");
                      IF VENDOR.FINDFIRST THEN
                      BEGIN
                        IF ((VENDOR."E-Mail"<>'') AND (VENDOR.Contact<>'')) THEN
                        BEGIN
                          FileDirectory := '\\erpserver\ErpAttachments\Purchase Orders\';
                          filname:=COPYSTR("No.",15,5);
                          filesub:=COPYSTR("No.",5,5);
                          FileName :='Purchase Order'+filesub+'-'+filname+ '.pdf';
                          PurchaseHeader.RESET;
                          PurchaseHeader.SETRANGE(PurchaseHeader."No.","No.");
                          REPORT.RUN(50058,FALSE,FALSE,PurchaseHeader);
                          REPORT.SAVEASPDF(50058,FileDirectory+FileName,PurchaseHeader);
                    
                          USER.RESET;
                          USER.SETRANGE(USER."User Name",USERID);
                          IF USER.FINDFIRST THEN
                            username:= USER."Full Name"
                          ELSE
                            username:= 'Brahmaiah V';
                    
                          VENDOR.RESET;
                          VENDOR.SETRANGE(VENDOR."No.","Buy-from Vendor No.");
                          IF VENDOR.FINDSET THEN
                          Mail_To:= VENDOR."E-Mail";
                           IF no_atch_items ='' THEN
                        BEGIN
                            IF Mail_count = 0 THEN
                              Subject:=' Purchase Order: '+"No."
                            ELSE
                              Subject:='Amendment to Purchase Order: '+"No.";
                              attachment:=FileDirectory+FileName;
                             // SMTP_MAIL.CreateMessage('Efftronics Systems Pvt. Ltd - Purchase order','erp@efftronics.com','sujani@efftronics.com',Subject,Body,TRUE);
                            SMTP_MAIL.CreateMessage('Efftronics Systems Pvt. Ltd - Purchase order','purchase@efftronics.com',Mail_To,Subject,Body,TRUE);
                        END
                        ELSE
                            BEGIN
                            Subject:=' Mechanical Items Requires the Attachements '+'Purchase Order: '+"No.";
                            attachment:=FileDirectory+FileName;
                    
                             // SMTP_MAIL.CreateMessage('Efftronics Systems Pvt. Ltd - Purchase order','erp@efftronics.com','sujani@efftronics.com',Subject,Body,TRUE);
                            SMTP_MAIL.CreateMessage('Efftronics Systems Pvt. Ltd - Purchase order','purchase@efftronics.com','mech@efftronics.com',Subject,Body,TRUE);
                          END;
                    
                    
                     PurchLine.RESET();
                     PurchLine.SETRANGE("Document No.","No.");
                      IF PurchLine.FINDSET THEN
                       REPEAT
                         BEGIN
                            MECH_ITEM := '';
                            IF Item.GET(PurchLine."No.") THEN
                            BEGIN
                               IF (Item."Item Category Code" = 'MECH') AND (NOT (Item."Product Group Code"  IN ['SHEET','SCREW','NUT','WASHER','BOLT','SHT','GENERAL','SPACER','HING','CLAMP','STUD'])) THEN
                                    MECH_ITEM := 'MECH'
                            END;
                            //MECH_ITEM := COPYSTR(PurchLine."No.",1,4);
                            MECH_ITEM_NO := PurchLine."No.";
                            IF MECH_ITEM = 'MECH' THEN
                            BEGIN
                                Attachements_Table.RESET();
                                Attachements_Table.SETRANGE("Document No.",MECH_ITEM_NO);
                                Attachements_Table.SETRANGE("Attachment Status",TRUE);
                                IF Attachements_Table.FINDSET THEN
                                BEGIN
                                    no_atch_items:='';
                                    IF Attachements_Table."Attachment Status"=FALSE THEN
                                      no_atch_items := no_atch_items +Attachements_Table."Document No."+'-'+PurchLine.Description+'<br/>'
                                    ELSE
                                      BEGIN
                                      Attachements_Table.ReadFilePath(FileName);
                                      FileDirectory_mech := '\\erpserver\ErpAttachments\Mechanical_Items\';
                                      DescriptionString := '';
                                      DescriptionString  := CONVERTSTR(Attachements_Table.Description,'/',' ');
                                      DescriptionString  := CONVERTSTR(DescriptionString,'\',' ');
                                      mech_filename := FileDirectory_mech + MECH_ITEM_NO+'-'+DescriptionString+'.'+Attachements_Table."File Extension";
                                      //mech_filename := FileDirectory_mech + MECH_ITEM_NO+'-'+DescriptionString+'.pdf';
                                      //mech_filename := FileName ;
                                      //Attachements_Table.ReadFilePath(mech_filename);
                                      SMTP_MAIL.AddAttachment(mech_filename,'');
                                      END;
                                  END
                                  ELSE
                                  no_atch_items:= no_atch_items + PurchLine."No." +'-'+PurchLine.Description+'<br/>';
                              END;
                            END;
                    
                        UNTIL PurchLine.NEXT = 0;
                    
                          SMTP_MAIL.AddAttachment(attachment,''); //EFFUPG
                          IF no_atch_items = '' THEN // having attachements
                            BEGIN
                                 Body:='Dear Sir/Madam,';//+VENDOR.Contact;
                                 Body+='<br><br><br>';
                                 Body+='Please see the attachment for purchase order and arrange the material at the earliest.<br>';
                                 Body+='Please send the order acknowledgment by return mail.<br><br><br>';
                                 Body+='Regards,<br>';
                                 Body+='<b>'+username+'<br> Purchase Department<BR>'+'Efftronics Systems Pvt. Ltd.,</b><BR>';
                                 Body+='40-15-9,Brundavan Colony,<br>Vijayawada - 520010,<br>Andhra Pradesh, India.<br>';
                                 Body+='Ph No : 0866-2466679(Direct)/2466699/75<br>';
                                 Body+='<br><br><b>Note: This is System generated Automail.</b><br>';
                                 SMTP_MAIL.AppendBody(Body);
                                // SMTP_MAIL.AddRecipients('sujani@efftronics.com');//MAIL TO VENDOR
                    
                                 SMTP_MAIL.AddRecipients(Mail_To);//MAIL TO VENDOR
                                 SMTP_MAIL.AddBCC('purchase@efftronics.com,erp@efftronics.com');
                                 SMTP_MAIL.Send;
                                 PurchaseHeader.RESET;
                                 PurchaseHeader.SETRANGE(PurchaseHeader."No.","No.");
                                IF PurchaseHeader.FINDFIRST THEN
                                   PurchaseHeader.Mail_Sent := CURRENTDATETIME;
                                   PurchaseHeader.Mail_count+=1;
                                   PurchaseHeader.MODIFY;
                                //MESSAGE('Mail Has Been Sent to '+Mail_To);
                            END ELSE
                          // ERROR('Mechanical Items '+no_atch_items+' Does not have Attachement');
                           BEGIN
                                 Body:='Dear Sir/Madam,';//+VENDOR.Contact;
                                 Body+='<br/>';
                                 Body+='PO'+PurchaseHeader."No."+' having the Mech Items with out attachemnts so PO is not sent to Vendor<br>';
                                 Body+='Add the Required attachments for the Following Items and after this acknowledge the Purchase Department to send the PO to Vendor <br>';
                                 Body+='Items List<br><br/>';
                                 Body+=no_atch_items+'<br/>';
                                 Body+='Regards,<br>';
                                 Body+='<b>'+username+'<br> Purchase Department<BR>'+'Efftronics Systems Pvt. Ltd.,</b><BR>';
                                 Body+='40-15-9,Brundavan Colony,<br>Vijayawada - 520010,<br>Andhra Pradesh, India.<br>';
                                 Body+='Ph No : 0866-2466679(Direct)/2466699/75<br>';
                                 Body+='<br><br><b>Note: This is System generated Automail.</b><br>';
                                 SMTP_MAIL.AppendBody(Body);
                                 SMTP_MAIL.AddRecipients('mech@efftronics.com');
                               //    SMTP_MAIL.AddRecipients('sujani@efftronics.com');
                                 SMTP_MAIL.AddBCC('purchase@efftronics.com,erp@efftronics.com');
                                 SMTP_MAIL.Send;
                    
                          // MESSAGE('Mail Has Been Sent to '+Mail_To);
                    
                          END;
                    
                         /* Body:='Dear Sir/Madam,';//+VENDOR.Contact;
                          Body+='<br><br><br>';
                          Body+='Please see the attachment for purchase order and arrange the material at the earliest.<br>';
                          Body+='Please send the order acknowledgment by return mail.<br><br><br>';
                    
                          Body+='Regards,<br>';
                          Body+='<b>'+username+'<br> Purchase Department<BR>'+'Efftronics Systems Pvt. Ltd.,</b><BR>';
                          Body+='40-15-9,Brundavan Colony,<br>Vijayawada - 520010,<br>Andhra Pradesh, India.<br>';
                          Body+='Ph No : 0866-2466679(Direct)/2466699/75<br>';
                          Body+='<br><br><b>Note: This is System generated Automail.</b><br>';
                          IF Mail_count = 0 THEN
                            Subject:=' Purchase Order: '+"No."
                          ELSE
                            Subject:='Amendment to Purchase Order: '+"No.";
                          attachment:=FileDirectory+FileName;
                          SMTP_MAIL.CreateMessage('Efftronics Systems Pvt. Ltd - Purchase order','purchase@efftronics.com',Mail_To,Subject,Body,TRUE);
                          SMTP_MAIL.AddBCC('purchase@efftronics.com,erp@efftronics.com');
                    
                          SMTP_MAIL.AddAttachment(attachment,''); //EFFUPG
                          SMTP_MAIL.Send;
                          MESSAGE('Mail Has Been Sent to '+Mail_To);
                          PurchaseHeader.RESET;
                          PurchaseHeader.SETRANGE(PurchaseHeader."No.","No.");
                          IF PurchaseHeader.FINDFIRST THEN
                            PurchaseHeader.Mail_Sent := CURRENTDATETIME;
                          PurchaseHeader.Mail_count+=1;
                          PurchaseHeader.MODIFY;*/
                    
                        END ELSE
                          ERROR('Supplier E-mail id/Supplier Name is not there to send the Order Details');
                      END;
                    END ELSE
                      ERROR('You Have No Rights to Send the order Details/Order May not be in the Released Mode');
                    
                    // end by Rakesh
                    
                    // commented by rakesh after adding new code
                    /*
                    IF (((USERID='EFFTRONICS\CHOWDARY') OR (USERID='EFFTRONICS\BRAHMAIAH')OR (USERID='EFFTRONICS\ANILKUMAR'))AND(Status=Status::Released))THEN
                    BEGIN
                    VENDOR.RESET;
                    VENDOR.SETRANGE(VENDOR."No.","Buy-from Vendor No.");
                    IF VENDOR.FINDFIRST THEN
                    BEGIN
                    IF ((VENDOR."E-Mail"<>'') AND (VENDOR.Contact<>'')) THEN
                    BEGIN
                    user1.RESET;
                    IF "OrderCreated by"<>'' THEN
                    user1.SETRANGE(user1."User Name","OrderCreated by")//Rev01
                    ELSE
                    user1.SETRANGE(user1."User Name","OrderCreated by");//Rev01
                    IF user1.FINDFIRST THEN
                    username:=user1."Full Name";//Rev01
                    BEGIN
                         // IF ISCLEAR(BullZipPDF) THEN
                         //   CREATE(BullZipPDF);
                    
                          ReportID := REPORT::"PO-with Authorised Sign";
                       //   FileDirectory := '\\eff-cpu-211\srinivas\';
                          FileDirectory := '\\erpserver\ErpAttachments\Purchase Orders\';
                    
                          Window.OPEN('processing  Order ######################1##');
                    
                          Object.GET(Object.Type::Report,'',ReportID);
                            purch1.SETRANGE(purch1."No.","No.");
                            IF purch1.FINDSET THEN REPEAT
                            Window.UPDATE(1,purch1."No.");
                            filname:=COPYSTR(purch1."No.",15,4);
                            filesub:=COPYSTR(purch1."No.",5,5);
                            FileName :='Purchase Order'+filesub+'-'+filname+ '.pdf';
                            {BullZipPDF.Init;
                            BullZipPDF.LoadSettings;
                            RunOnceFile := BullZipPDF.GetSettingsFileName(TRUE);
                            BullZipPDF.SetValue('Output',FileDirectory+FileName);
                            BullZipPDF.SetValue('Showsettings', 'never');
                            BullZipPDF.SetValue('ShowPDF', 'no');
                            BullZipPDF.SetValue('ShowProgress', 'no');
                            BullZipPDF.SetValue('ShowProgressFinished', 'no');
                            BullZipPDF.SetValue('SuppressErrors', 'yes');
                            BullZipPDF.SetValue('ConfirmOverwrite', 'no');
                            BullZipPDF.WriteSettings(TRUE);
                            purch:=purch1;
                            purch.SETRECFILTER;
                            REPORT.RUNMODAL(ReportID,FALSE,FALSE,purch);
                            TimeOut := 0;
                            WHILE EXISTS(RunOnceFile) AND (TimeOut < 10) DO BEGIN
                                SLEEP(2000);
                                TimeOut := TimeOut + 1;
                            END;               }
                          UNTIL purch1.NEXT=0;
                    
                          Window.CLOSE;
                        END;
                    {"Mail-Id".SETRANGE("Mail-Id"."User ID",USERID);
                    IF "Mail-Id".FINDFIRST THEN
                    Mail_From:="Mail-Id".MailID
                    ELSE
                    ERROR('You Do not Have the Mail Id,please Contact Administrator to create your Mail id');}
                    
                    IF "OrderCreated by"<>'' THEN
                    "Mail-Id".SETRANGE("Mail-Id"."User Name","OrderCreated by")//Rev01
                    ELSE
                    "Mail-Id".SETRANGE("Mail-Id"."User Name",USERID); //Rev01
                    IF "Mail-Id".FINDFIRST THEN
                    Mail_To:="Mail-Id".MailID
                    ELSE
                    ERROR('You Do not Have the Mail Id,please Contact Administrator to create your Mail id');
                    
                    Body:='Dear '+VENDOR.Contact;
                    Body+='<br><Br> EMail-id: '+VENDOR."E-Mail";
                    Body+='<br><br><br>';
                    Body+='Please see the attachment for purchase order and arrange the material at the earliest.<br>';
                    Body+='Please send the order acknowledgment by return mail.<br><br><br>';
                    
                    Body+='Regards,<br>';
                    Body+=username+'<br>Efftronics Systems Pvt. Ltd.,<BR>';
                    Body+='Phone No.:+91-866-2493375<br>';
                    Body+='Mobile No.:+09392110072<br>';
                    Body+='C.S.T No.:VJ2-07-1-1976/02-05-1988<br>';
                    Body+='T.I.N. No.:28350166764 <br>';
                    Body+='E.C.C. NO.:AAACE4879QST001 <br>';
                    //MESSAGE(FORMAT(VENDOR."E-Mail"));
                         Mail_From:='erp@efftronics.com';
                    //    Mail_To:='sreenu@efftronics.com';
                    //     Mail_To:='sreenu@efftronics.com,anilkumar@efftronics.com,chowdary@efftronics.com';
                    //     Mail_To:=vendor."E-Mail";
                         Subject:=' Purchase Order: '+purch1."No."+' Order Created By: '+username;
                         attachment:=FileDirectory+FileName;
                         SMTP_MAIL.CreateMessage('Efftronics Systems Pvt. Ltd','purchase@efftronics.com','santhoshk@efftronics.com',Subject,Body,TRUE)
                    ;
                         SMTP_MAIL.AddAttachment(attachment);
                         SMTP_MAIL.Send;
                        // NewCDOMessage(Mail_From,Mail_To,Subject,Body,attachment);
                         MESSAGE('Mail Has Been Sent');
                    END ELSE
                    ERROR('Supplier E-mail id/Supplier Name is not there to send the Order Details');
                    END;
                    END ELSE
                    ERROR('You Have No Rights to Send the order Detials/Order May Not be in the Released Mode');
                    */

                end;
            }
            action("Copy Indent")
            {
                Caption = 'Copy Indent';
                Image = CopyItem;

                trigger OnAction();
                begin
                    CopyIndent;
                end;
            }
            action("Resend Mail")
            {
                Caption = 'Resend Mail';
                Image = SendAsPDF;

                trigger OnAction();
                begin
                    IF UPPERCASE(USERID) IN ['EFFTRONICS\PARDHU','EFFTRONICS\BRAHMAIAH','EFFTRONICS\CHOWDARY','EFFTRONICS\PADMASRI','EFFTRONICS\RENUKACH','SUPER','EFFTRONICS\SUJANI','EFFTRONICS\SPURTHI','EFFTRONICS\ANVESH'] THEN
                    BEGIN
                      IF Status=Status::Released THEN
                        Mails
                      ELSE
                        ERROR('Release the Order');
                      END
                    ELSE
                    ERROR('You have no Rights to perform this operation');
                end;
            }
        }
        addafter("Action 19")
        {
            action(Refresh)
            {
                Caption = 'Refresh';
                Image = Refresh;
                Promoted = true;
                PromotedCategory = Process;

                trigger OnAction();
                var
                    ReleasePurchDoc : Codeunit "Release Purchase Document";
                begin

                        IF ISCLEAR(SQLConnection) THEN
                          CREATE(SQLConnection,FALSE,TRUE); //Rev01
                        //CREATE(SQLConnection);
                      IF ISCLEAR(RecordSet) THEN
                        CREATE(RecordSet,FALSE,TRUE); //Rev01
                         //CREATE(RecordSet);

                      WebRecStatus := Quotes+Text50001+Quotes;
                      OldWebStatus := Quotes+Text50002+Quotes;
                      SQLConnection.ConnectionString :='DSN=PUR_AUT;UID=cashflowuser;PASSWORD=firewall123;SERVER=oracle_80;';
                      SQLConnection.Open;
                      SQLQuery:='select TO_CHAR(Status) STATUS from PURCHASE_ORDER where Purchase_order_No='''+"No."+''' and trans_no=';
                      SQLQuery+='(select Max(Trans_no) from Purchase_Order where purchase_order_no='''+"No."+''')';
                      RecordSet := SQLConnection.Execute(SQLQuery);
                      IF NOT (RecordSet.EOF OR RecordSet.BOF) THEN
                      BEGIN


                        IF FORMAT(RecordSet.Fields.Item('STATUS').Value)='1' THEN
                          CODEUNIT.RUN(415,Rec)
                        ELSE
                          ReleasePurchDoc.Reopen(Rec);
                        SQLConnection.Close;
                      END ELSE
                      BEGIN
                        SQLConnection.Close;
                        ERROR('THERE IS NO REQUEST (OR) NO APPROVAL FOR THIS PURCHASE ORDER');

                      END;

                    // added by vishnu priya for 18-12-2018 for the Minimum Order value checking.
                end;
            }
            action(minimumordervaluecheck)
            {
                Caption = 'moa';

                trigger OnAction();
                begin
                    VENDOR.RESET;
                    VENDOR.SETCURRENTKEY("No.");
                    VENDOR.SETFILTER("No.",Rec."Buy-from Vendor No.");
                    IF VENDOR.FINDFIRST THEN
                      BEGIN
                        PL.RESET;
                        PL.SETFILTER("Document No.",Rec."No.");
                        ORDER_VAL := 0;
                        IF PL.FINDSET THEN
                          REPEAT
                            BEGIN
                              ORDER_VAL := ORDER_VAL+PL.Amount;
                            END
                        UNTIL PL.NEXT= 0;
                        IF VENDOR."Minimum Order Value" > ORDER_VAL THEN
                        ERROR('Purchase Order value %2 < Vendor Minimum Order Value is %1 So You can'''+'t Raise the PO',VENDOR."Minimum Order Value",ORDER_VAL);
                       END;

                    MESSAGE('Vendor Minimum Order Value= %1 , Purchase Order Value = %2',VENDOR."Minimum Order Value",ORDER_VAL);
                end;
            }
            action(IndentExistedOrnotcheck)
            {

                trigger OnAction();
                begin
                    //ADDED BY VISHNU PRIYA ON 06-07-2019
                    PL.RESET;
                    PL.SETRANGE("Document No.",Rec."No.");
                    PL.SETRANGE(PL.Type,PL.Type::"G/L Account",PL.Type::Item);
                    IF PL.FINDSET THEN REPEAT
                      IF PL."Indent No." = '' THEN
                          ERROR('There is No Indent to Line Number: '+FORMAT(PL."Line No."));
                      UNTIL PL.NEXT = 0;
                end;
            }
        }
    }


    //Unsupported feature: PropertyModification on "Action 53.OnAction.ApprovalEntries(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 53.OnAction.ApprovalEntries : 658;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 53.OnAction.ApprovalEntries : "Approval Entries";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 228.OnAction.PurchHeader(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 228.OnAction.PurchHeader : 38;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 228.OnAction.PurchHeader : "Purchase Header";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 228.OnAction.DistIntegration(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 228.OnAction.DistIntegration : 5702;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 228.OnAction.DistIntegration : "Dist. Integration";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Approve(Action 35).OnAction.ApprovalsMgmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Approve : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Approve : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Reject(Action 33).OnAction.ApprovalsMgmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Reject : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Reject : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Delegate(Action 31).OnAction.ApprovalsMgmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Delegate : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Delegate : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Comment(Action 29).OnAction.ApprovalsMgmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Comment : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Comment : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Release(Action 137).OnAction.ReleasePurchDoc(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Release : 415;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Release : "Release Purchase Document";
        //Variable type has not been exported.

    var
        vendorRec : Record Vendor;


    //Unsupported feature: PropertyModification on "Reopen(Action 138).OnAction.ReleasePurchDoc(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Reopen : 415;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Reopen : "Release Purchase Document";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 179.OnAction.StdVendPurchCode(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 179.OnAction.StdVendPurchCode : 175;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 179.OnAction.StdVendPurchCode : "Standard Vendor Purchase Code";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on ""Update Reference Invoice No"(Action 1580003).OnAction.ReferenceInvoiceNo(Variable 1500000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //"Update Reference Invoice No" : 16470;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //"Update Reference Invoice No" : "Reference Invoice No.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on ""Update Reference Invoice No"(Action 1580003).OnAction.UpdateReferenceInvoiceNo(Variable 1500001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //"Update Reference Invoice No" : 16627;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //"Update Reference Invoice No" : "Update Reference Invoice No";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 187.OnAction.DistIntegration(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 187.OnAction.DistIntegration : 5702;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 187.OnAction.DistIntegration : "Dist. Integration";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 187.OnAction.PurchHeader(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 187.OnAction.PurchHeader : 38;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 187.OnAction.PurchHeader : "Purchase Header";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 195.OnAction.ICInOutboxMgt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 195.OnAction.ICInOutboxMgt : 427;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 195.OnAction.ICInOutboxMgt : ICInboxOutboxMgt;
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 195.OnAction.ApprovalsMgmt(Variable 1003)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 195.OnAction.ApprovalsMgmt : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 195.OnAction.ApprovalsMgmt : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "IncomingDocCard(Action 47).OnAction.IncomingDocument(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //IncomingDocCard : 130;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //IncomingDocCard : "Incoming Document";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "SelectIncomingDoc(Action 45).OnAction.IncomingDocument(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //SelectIncomingDoc : 130;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //SelectIncomingDoc : "Incoming Document";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "IncomingDocAttachFile(Action 43).OnAction.IncomingDocumentAttachment(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //IncomingDocAttachFile : 133;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //IncomingDocAttachFile : "Incoming Document Attachment";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "SendApprovalRequest(Action 57).OnAction.ApprovalsMgmt(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //SendApprovalRequest : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //SendApprovalRequest : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "CancelApprovalRequest(Action 55).OnAction.ApprovalsMgmt(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //CancelApprovalRequest : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //CancelApprovalRequest : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 149.OnAction.GetSourceDocInbound(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 149.OnAction.GetSourceDocInbound : 5751;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 149.OnAction.GetSourceDocInbound : "Get Source Doc. Inbound";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Preview(Action 21).OnAction.PurchPostYesNo(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Preview : 91;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Preview : "Purch.-Post (Yes/No)";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "PostPrepaymentInvoice(Action 203).OnAction.ApprovalsMgmt(Variable 1002)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //PostPrepaymentInvoice : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //PostPrepaymentInvoice : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "PostPrepaymentInvoice(Action 203).OnAction.PurchPostYNPrepmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //PostPrepaymentInvoice : 445;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //PostPrepaymentInvoice : "Purch.-Post Prepmt.  (Yes/No)";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 210.OnAction.ApprovalsMgmt(Variable 1002)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 210.OnAction.ApprovalsMgmt : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 210.OnAction.ApprovalsMgmt : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 210.OnAction.PurchPostYNPrepmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 210.OnAction.PurchPostYNPrepmt : 445;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 210.OnAction.PurchPostYNPrepmt : "Purch.-Post Prepmt.  (Yes/No)";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "PostPrepaymentCreditMemo(Action 204).OnAction.ApprovalsMgmt(Variable 1002)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //PostPrepaymentCreditMemo : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //PostPrepaymentCreditMemo : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "PostPrepaymentCreditMemo(Action 204).OnAction.PurchPostYNPrepmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //PostPrepaymentCreditMemo : 445;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //PostPrepaymentCreditMemo : "Purch.-Post Prepmt.  (Yes/No)";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 211.OnAction.ApprovalsMgmt(Variable 1002)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 211.OnAction.ApprovalsMgmt : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 211.OnAction.ApprovalsMgmt : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "Action 211.OnAction.PurchPostYNPrepmt(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //Action 211.OnAction.PurchPostYNPrepmt : 445;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //Action 211.OnAction.PurchPostYNPrepmt : "Purch.-Post Prepmt.  (Yes/No)";
        //Variable type has not been exported.

    var
        ResultSteps : Integer;


    //Unsupported feature: PropertyModification on "SaveInvoiceDiscountAmount(PROCEDURE 14).DocumentTotals(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //SaveInvoiceDiscountAmount : 57;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //SaveInvoiceDiscountAmount : "Document Totals";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "SetDocNoVisible(PROCEDURE 2).DocumentNoVisibility(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //SetDocNoVisible : 1400;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //SetDocNoVisible : DocumentNoVisibility;
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "SetDocNoVisible(PROCEDURE 2).DocType(Variable 1003)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //SetDocNoVisible : Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //SetDocNoVisible : Quote,Order,Invoice,"Credit Memo","Blanket Order","Return Order",Reminder,FinChMemo;
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "SetExtDocNoMandatoryCondition(PROCEDURE 3).PurchasesPayablesSetup(Variable 1000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //SetExtDocNoMandatoryCondition : 312;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //SetExtDocNoMandatoryCondition : "Purchases & Payables Setup";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "SetControlAppearance(PROCEDURE 5).ApprovalsMgmt(Variable 1002)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //SetControlAppearance : 1535;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //SetControlAppearance : "Approvals Mgmt.";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "PurchSetup(Variable 150000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //PurchSetup : 312;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //PurchSetup : "Purchases & Payables Setup";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "ChangeExchangeRate(Variable 1001)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //ChangeExchangeRate : 511;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //ChangeExchangeRate : "Change Exchange Rate";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "CopyPurchDoc(Variable 1002)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //CopyPurchDoc : 492;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //CopyPurchDoc : "Copy Purchase Document";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "MoveNegPurchLines(Variable 1006)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //MoveNegPurchLines : 6698;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //MoveNegPurchLines : "Move Negative Purchase Lines";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "ReportPrint(Variable 1003)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //ReportPrint : 228;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //ReportPrint : "Test Report-Print";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "DocPrint(Variable 1004)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //DocPrint : 229;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //DocPrint : "Document-Print";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "UserMgt(Variable 1005)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //UserMgt : 5700;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //UserMgt : "User Setup Management";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "ArchiveManagement(Variable 1007)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //ArchiveManagement : 5063;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //ArchiveManagement : ArchiveManagement;
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "PurchCalcDiscByType(Variable 1009)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //PurchCalcDiscByType : 66;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //PurchCalcDiscByType : "Purch - Calc Disc. By Type";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "GSTManagement(Variable 1500120)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //GSTManagement : 16401;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //GSTManagement : "GST Management";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "PurchLine(Variable 1280003)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //PurchLine : 39;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //PurchLine : "Purchase Line";
        //Variable type has not been exported.


    //Unsupported feature: PropertyModification on "DefermentBuffer(Variable 1500000)". Please convert manually.

    //var
        //>>>> ORIGINAL VALUE:
        //DefermentBuffer : 16532;
        //Variable type has not been exported.
        //>>>> MODIFIED VALUE:
        //DefermentBuffer : "Deferment Buffer";
        //Variable type has not been exported.

    var
        MLTransactionType : Option Purchase,Sale;
        Text33000260 : Label 'Do you want to Cancel Quality Inspection?';
        Text33000261 : Label 'Do you want to Close Quality Inspection?';
        PurchaseHeader : Record "Purchase Header";
        "Excepted Rcpt.Date Tracking" : Record "Excepted Rcpt.Date Tracking";
        VENDOR : Record Vendor;
        FileDirectory : Text[100];
        FileName : Text[100];
        ReportID : Integer;
        "Object" : Record "Object";
        Window : Dialog;
        RunOnceFile : Text[1000];
        TimeOut : Integer;
        Customer : Record Customer;
        Customer2 : Record Customer;
        purch : Record "Purchase Header";
        purch1 : Record "Purchase Header";
        attachment : Text[1000];
        SMTPSETUP : Record "SMTP SETUP";
        AttachFileName : Text[1000];
        objEmailConf : Automation "'{CD000000-8B95-11D1-82DB-00C04FB1625D}' 1.0:'{CD000002-8B95-11D1-82DB-00C04FB1625D}':''{CD000000-8B95-11D1-82DB-00C04FB1625D}' 1.0'.Configuration";
        objEmail : Automation "'{CD000000-8B95-11D1-82DB-00C04FB1625D}' 1.0:'{CD000001-8B95-11D1-82DB-00C04FB1625D}':''{CD000000-8B95-11D1-82DB-00C04FB1625D}' 1.0'.Message";
        flds : Automation "'{00000205-0000-0010-8000-00AA006D2EA4}' 2.5:'{00000564-0000-0010-8000-00AA006D2EA4}':''{00000205-0000-0010-8000-00AA006D2EA4}' 2.5'.Fields";
        fld : Automation "'{00000205-0000-0010-8000-00AA006D2EA4}' 2.5:'{00000569-0000-0010-8000-00AA006D2EA4}':''{00000205-0000-0010-8000-00AA006D2EA4}' 2.5'.Field";
        bodies : Integer;
        Mail_Body : Text[1000];
        body1 : Text[1000];
        filname : Text[100];
        filesub : Text[30];
        "Mail-Id" : Record User;
        "from Mail" : Text[500];
        "to mail" : Text[1000];
        username : Text[50];
        user1 : Record User;
        Body : Text[1024];
        Mail_From : Text[250];
        Mail_To : Text[250];
        Mail : Codeunit "SMTP Mail";
        Subject : Text[250];
        j : Integer;
        Prev_Indent : Code[20];
        PL : Record "Purchase Line";
        INDENT_HEADER : Record "Indent Header";
        noofdays : Text[100];
        dateofit : Date;
        USER : Record User;
        CashFlowConnection : Codeunit "Cash Flow Connection";
        StructureOrderLineDetails : Record "Structure Order Line Details";
        "Packing Value" : Decimal;
        "Payment Terms" : Record "Payment Terms";
        Frieght_Value : Decimal;
        Insurance_Value : Decimal;
        Additional_Duty : Decimal;
        Service_Amount : Decimal;
        Structure_Order_Details : Record "Structure Order Details";
        Packing_Calculation : Boolean;
        Unit_Cost : Decimal;
        Line_Amount : Decimal;
        "G\L" : Record "General Ledger Setup";
        SQLConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000514-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Connection";
        RecordSet : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000535-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Recordset";
        SQLQuery : Text[1000];
        LRecordSet : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000535-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Recordset";
        LineSQLQuery : Text[250];
        HeadID : Text[30];
        UpdateWebHead : Text[250];
        WebRecStatus : Text[30];
        OldWebStatus : Text[30];
        Reason_window : Dialog;
        Reason : Text[100];
        T1 : Label 'Please Enter the Reason to Reopen the Order #1######################';
        Quotes : Label '''';
        Text50001 : Label 'NEW';
        Text50002 : Label 'OLD';
        SMTP_MAIL : Codeunit "SMTP Mail";
        VAT_AMOUNT : Decimal;
        CST_AMOUNT : Decimal;
        Dept : Code[10];
        fname : Text[30];
        flag : Boolean;
        str : Text[30];
        Text19023272 : Label 'Buy-from Vendor';
        Text19005663 : Label 'Pay-to Vendor';
        "--Rev01" : Integer;
        [InDataSet]
        PurchHistoryBtnVisible : Boolean;
        [InDataSet]
        PurchHistoryBtn1Visible : Boolean;
        [InDataSet]
        PayToCommentBtnVisible : Boolean;
        [InDataSet]
        PayToCommentPictVisible : Boolean;
        PurchInfoPaneMgmt : Codeunit "Purchases Info-Pane Management";
        Text001 : Label 'Cashflow connection does not exist. Do you want to Continue?';
        item : Record Item;
        Vndr : Record Vendor;
        GST_AMOUNT : Decimal;
        Text022 : Label 'MECH_ITEM.';
        MECH_ITEM : Text[500];
        MECH_ITEM_NO : Text[500];
        Attachements_Table : Record Attachments;
        Mech_item_file_name : Text[500];
        mech_filename : Text[500];
        no_atch_items : Text;
        FileDirectory_mech : Text[100];
        moa : Page "Purchase Order Statistics";
                  ORDER_VAL : Decimal;
                  Pur_line : Record "Purchase Line";
                  ten_percent_cost : Decimal;
                  items_list_cost : array [100,3] of Code[30];
                  LoopVar : Integer;
                  options_itm_cost : Text;
                  itm_loop : Integer;
                  indentline : Record "Indent Line";
                  tds_amt : Decimal;
                  PurchHead : Record "Purchase Header";


    //Unsupported feature: CodeModification on "OnAfterGetRecord". Please convert manually.

    //trigger OnAfterGetRecord();
    //>>>> ORIGINAL CODE:
    //begin
    /*
    SetControlAppearance;
    SetLocGSTRegNoEditable;
    */
    //end;
    //>>>> MODIFIED CODE:
    //begin
    /*
    IF Structure='FORIEGN' THEN
      BEGIN
        CurrPage.PurchLines.PAGE.Show_Custom_Charges(TRUE);
        //CurrPage.PurchLines.PAGE.UPDATE; //Rev01
      END ELSE
      BEGIN
        CurrPage.PurchLines.PAGE.Show_Custom_Charges(FALSE);
        //CurrPage.PurchLines.PAGE.UPDATE;//Rev01
      END;

    //UpdateInfoPanel; // Rev01 //EFFUPG Function doesn't exist in NAV 2016 Base
    SetControlAppearance;
    SetLocGSTRegNoEditable;
    */
    //end;


    //Unsupported feature: CodeModification on "OnDeleteRecord". Please convert manually.

    //trigger OnDeleteRecord() : Boolean;
    //>>>> ORIGINAL CODE:
    //begin
    /*
    CurrPage.SAVERECORD;
    EXIT(ConfirmDeletion);
    */
    //end;
    //>>>> MODIFIED CODE:
    //begin
    /*
    {IF NOT (USERID IN['EFFTRONICS\PRANAVI','EFFTRONICS\ANILKUMAR','EFFTRONICS\ANVESH','EFFTRONICS\SPURTHI','EFFTRONICS\VIJAYA','EFFTRONICS\VSUSMITHA']) THEN    //Added by Pranavi on 03-Dec-2015
      ERROR('You Do Not Have Rights to Delete!');
      }


    CurrPage.SAVERECORD;
    EXIT(ConfirmDeletion);
    */
    //end;


    //Unsupported feature: CodeInsertion on "OnNewRecord". Please convert manually.

    //trigger (Variable: ResultSteps)();
    //Parameters and return type have not been exported.
    //begin
    /*
    */
    //end;


    //Unsupported feature: CodeModification on "OnNewRecord". Please convert manually.

    //trigger OnNewRecord(BelowxRec : Boolean);
    //>>>> ORIGINAL CODE:
    //begin
    /*
    "Responsibility Center" := UserMgt.GetPurchasesFilter;
    */
    //end;
    //>>>> MODIFIED CODE:
    //begin
    /*
    "Responsibility Center" := UserMgt.GetPurchasesFilter;
    TESTFIELD(Status,Status::Open);
    */
    //end;


    //Unsupported feature: CodeModification on "OnOpenPage". Please convert manually.

    //trigger OnOpenPage();
    //>>>> ORIGINAL CODE:
    //begin
    /*
    SetDocNoVisible;

    IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
      FILTERGROUP(2);
      SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter);
      FILTERGROUP(0);
    END;
    SetLocGSTRegNoEditable;
    */
    //end;
    //>>>> MODIFIED CODE:
    //begin
    /*
    SetDocNoVisible;
    DocNoVisible:=TRUE;   // Pranavi on 19-Apr-2017
    #3..8

    IF (Structure = 'PURCH_GST') AND (USERID = 'EFFTRONICS\VIJAYA')  THEN
    BEGIN
    IF "Buy-from Vendor No." <> '' THEN
      BEGIN

        IF (Status = Status::Open)  THEN
        BEGIN
        VENDOR.RESET;
        VENDOR.SETFILTER(VENDOR."No.","Buy-from Vendor No.");
        IF VENDOR.FINDFIRST THEN
            "GST Vendor Type" := VENDOR."GST Vendor Type";
        MODIFY;
          PL.RESET;
          PL.SETFILTER(PL."Document No.", "No.");
          IF PL.FINDSET THEN
          REPEAT
              IF (PL.Type = PL.Type::Item) AND ( PL."No." <> '') THEN
              BEGIN
                  item.GET(PL."No.");
                  IF (PL."HSN/SAC Code" = '')  THEN
                      PL."HSN/SAC Code" := item."HSN/SAC Code";
                  IF (PL."GST Group Code" = '') THEN
                      PL."GST Group Code" := item."GST Group Code";

                  //PL.VALIDATE(Quantity, PL.Quantity);
              END;
          UNTIL PL.NEXT = 0;
        END;
    END;
    END;

    {PL.RESET;
    PL.SETFILTER(PL."Document No.", "No.");
    IF PL.FINDSET THEN
      REPEAT
      IF ( PL."No." <> '') THEN
    BEGIN
     IF Rec."Location Code" ='CONSTRUCTI' THEN
         BEGIN
           IF (PL."Location Code" ='') OR (PL."Location Code" <> Rec."Location Code") THEN
              BEGIN
                 PL."Location Code" := Rec."Location Code";
                 MODIFY;
               END;
        END;
    END;
    UNTIL PL.NEXT=0;}

    // added by vishnu priya on 06-07-2019 to update purchase order number and line number to indent lines
    {
    indentline.RESET;
    indentline.SETCURRENTKEY("Document No.","Line No.");
    PL.RESET;
    PL.SETFILTER("Document No.","No.");
    PL.SETFILTER("Indent No.",'<>%1','');
    IF PL.FINDSET THEN
    REPEAT
      indentline.SETFILTER("Base Indent Number",PL."Indent No.");
      indentline.SETRANGE("Base Indent Line Number",PL."Indent Line No.");
      IF indentline.FINDFIRST THEN BEGIN
      indentline."Purchase Order Number" := PL."Document No.";
      indentline."Purchase Order Line Number" := PL."Line No.";
      indentline.MODIFY;
      END;
    UNTIL PL.NEXT = 0;
    }
    // end by vishnu priya on 06-07-2019 to update purchase order number and line number to indent lines
    */
    //end;

    //event SQLConnection(pError : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000500-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Error";adStatus : Integer;pConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000550-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Connection");
    //begin
    /*
    */
    //end;

    //event SQLConnection(TransactionLevel : Integer;pError : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000500-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Error";adStatus : Integer;pConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000550-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Connection");
    //begin
    /*
    */
    //end;

    //event SQLConnection(pError : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000500-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Error";adStatus : Integer;pConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000550-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Connection");
    //begin
    /*
    */
    //end;

    //event SQLConnection(pError : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000500-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Error";adStatus : Integer;pConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000550-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Connection");
    //begin
    /*
    */
    //end;

    //event SQLConnection(var Source : Text;CursorType : Integer;LockType : Integer;var Options : Integer;adStatus : Integer;pCommand : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{B08400BD-F9D1-4D02-B856-71D5DBA123E9}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Command";pRecordset : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000556-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Recordset";pConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000550-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Connection");
    //begin
    /*
    */
    //end;

    //event SQLConnection(RecordsAffected : Integer;pError : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000500-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Error";adStatus : Integer;pCommand : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{B08400BD-F9D1-4D02-B856-71D5DBA123E9}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Command";pRecordset : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000556-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Recordset";pConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000550-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Connection");
    //begin
    /*
    */
    //end;

    //event SQLConnection(var ConnectionString : Text;var UserID : Text;var Password : Text;var Options : Integer;adStatus : Integer;pConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000550-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Connection");
    //begin
    /*
    */
    //end;

    //event SQLConnection(pError : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000500-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'.Error";adStatus : Integer;pConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000550-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Connection");
    //begin
    /*
    */
    //end;

    //event SQLConnection(adStatus : Integer;pConnection : Automation "'{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8:'{00000550-0000-0010-8000-00AA006D2EA4}':''{2A75196C-D9EB-4129-B803-931327F72D5C}' 2.8'._Connection");
    //begin
    /*
    */
    //end;

    [LineStart(5149)]
    procedure CommaRemoval(Base: Text[30]) Converted: Text[30];
    var
        i: Integer;
    begin
        FOR i := 1 TO STRLEN(Base) DO BEGIN
            IF COPYSTR(Base, i, 1) <> ',' THEN
                Converted += COPYSTR(Base, i, 1);
        END;
        EXIT(Converted);
    end;

    [LineStart(5157)]
    procedure Order_Value("Order_No.": Code[20]) Value: Decimal;
    begin
        PL.SETRANGE(PL."Document No.", "Order_No.");
        IF PL.FINDSET THEN
            REPEAT
                IF PL."Currency Code" = '' THEN
                    Value += PL."Direct Unit Cost" * PL.Quantity
                ELSE
                    Value += PL."Unit Cost (LCY)" * PL.Quantity;
                StructureOrderLineDetails.RESET;
                StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails.Type, StructureOrderLineDetails.Type::Purchase);
                StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails."Document No.", PurchLine."Document No.");
                StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails."Line No.", PurchLine."Line No.");
                StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails.Type, StructureOrderLineDetails.Type::Purchase);
                IF StructureOrderLineDetails.FINDSET THEN
                    REPEAT
                        Value += StructureOrderLineDetails."Amount (LCY)";
                    UNTIL StructureOrderLineDetails.NEXT = 0;
            UNTIL PL.NEXT = 0;
    end;

    [LineStart(5176)]
    procedure Mails();
    var
        Lpurchase: Record "Purchase Header";
    begin


        /*Mail_From:='ERP@efftronics.com';
        
        Mail_To:='sujani@efftronics.com';
        SMTP_MAIL.CreateMessage('EFF',Mail_From,Mail_To,'PO ISSUE','PO ISSUE'+ "USER ID" + Rec."No.",TRUE);
        SMTP_MAIL.Send;*/
        /*
        
        IF UPPERCASE(USERID) IN ['EFFTRONICS\MNRAJU','EFFTRONICS\RAKESHT'] THEN
        Mail_To:='mnraju@efftronics.com,rakesht@efftronics.com'
        ELSE
        Mail_To:='purchase@efftronics.com,ramkumarl@efftronics.com,anilkumar@efftronics.com';
        
        //Mail_To:=VENDOR."E-Mail";
        fname:='';
        str:='';
        
        flag:=FALSE;
        
        IF (Mail_Sent=FALSE) THEN
        BEGIN
          IF (DIALOG.CONFIRM('Send Mail to: '+Mail_To)) THEN
            flag:=TRUE;
        END
        ELSE IF(Mail_Sent=TRUE) THEN
        BEGIN
          IF  (DIALOG.CONFIRM('Resend Mail to: '+Mail_To)) THEN
          BEGIN
            flag:=TRUE;
          END;
        END;
        
        
        IF flag=TRUE THEN
        BEGIN
          str:="No.";
          PurchaseHeader.SETFILTER(PurchaseHeader."No.","No.");
          WHILE STRPOS(str,'/') > 1 DO BEGIN
            fname:=fname+COPYSTR(str,1,STRPOS(str,'/')-1)+'_';
            str := COPYSTR(str,STRPOS(str,'/') + 1);
          END;
          fname:=fname+str;
        
          IF ISCLEAR(Bullzippdf) THEN
          CREATE(Bullzippdf,FALSE,TRUE); //Rev01
          //CREATE(Bullzippdf); //Rev01
        
          FileDirectory :='\\erpserver\ErpAttachments\PurchaseOrders\';
          Window.OPEN('PREPARING THE REPORT');
          FileName :=fname+'.pdf';
          Bullzippdf.Init;
          Bullzippdf.LoadSettings;
          RunOnceFile := Bullzippdf.GetSettingsFileName(TRUE);
          Bullzippdf.SetValue('Output',FileDirectory+FileName);
          Bullzippdf.SetValue('Showsettings', 'never');
          Bullzippdf.SetValue('ShowPDF', 'no');
          Bullzippdf.SetValue('ShowProgress', 'no');
          Bullzippdf.SetValue('ShowProgressFinished', 'no');
          Bullzippdf.SetValue('SuppressErrors', 'yes');
          Bullzippdf.SetValue('ConfirmOverwrite', 'no');
          Bullzippdf.WriteSettings(TRUE);
        
          REPORT.RUNMODAL(50058,FALSE,FALSE,PurchaseHeader);
          TimeOut := 0;
        
          WHILE EXISTS(RunOnceFile) AND (TimeOut < 10) DO
          BEGIN
            SLEEP(2000);
            TimeOut := TimeOut + 1;
          END;
          Window.CLOSE;
        
          attachment:=FileDirectory+FileName;
          Subject:='Reg : Purchase order - '+str;
          Body:='<HTML><BODY>Dear Sir,<BR>';
          Body+='<BR><PRE>  Please find the attachment for purchase order and arrange the material at the earliest</PRE>';
          Body+='<PRE><B>and send the order acknowledgment by return mail (without fail ).</B></PRE>';
          Body+='<PRE>             ****  Automatic Mail Generated From ERP  ****</PRE></BODY></HTML>';
        
          SMTP_MAIL.CreateMessage('EFF',Mail_From,Mail_To,Subject,Body,TRUE);
          SMTP_MAIL.AddAttachment(attachment);
          SMTP_MAIL.Send;
          //SLEEP(5000);
        
        
          IF PurchaseHeader.FINDFIRST THEN
          REPEAT
            PurchaseHeader.Mail_Sent:=TRUE;
            PurchaseHeader.MODIFY;
          UNTIL PurchaseHeader.NEXT=0;
        
          MESSAGE('Mail has been Sent');
        END;
        */

    end;

    [LineStart(5320)]
    procedure "...........Rev01............."();
    begin
    end;

    [LineStart(5323)]
    procedure Testing(Purchase_Order_No: Text);
    var
        "Count": Integer;
    begin
        Count := 0;
        SETFILTER("No.", Purchase_Order_No);
        IF FINDFIRST THEN
            REPEAT
                Count := Count + 1;
            UNTIL NEXT = 0;
        MESSAGE('No.of Orders Relesed is :: %1', Purchase_Order_No);
        RESET;
    end;

    [LineStart(5333)]
    procedure Testing1(PurchHdrGRec: Record "Purchase Header");
    begin
        MESSAGE('Testing Calc Structure!');
        "G\L".GET;
        IF "G\L"."Active ERP-CF Connection" THEN BEGIN
            PurchHdrGRec.TESTFIELD(Status, Status::Open);
            PurchHdrGRec.TESTFIELD(Structure);
            PurchHdrGRec.TESTFIELD("Order Date");
            PurchHdrGRec."Calculate Tax Structure" := TRUE;
            PurchHdrGRec.MODIFY;
        END;

        PurchLine.CalculateStructures(PurchHdrGRec);
        PurchLine.AdjustStructureAmounts(PurchHdrGRec);
        PurchLine.UpdatePurchLines(PurchHdrGRec);
    end;

    [LineStart(5349)]
    procedure StructureDetails(PurchaseHeader: Record "Purchase Header"; Is_Release: Boolean);
    begin
        "G\L".GET;
        IF "G\L"."Active ERP-CF Connection" THEN BEGIN
            PurchaseHeader.TESTFIELD(Status, Status::Open);
            PurchaseHeader.TESTFIELD(Structure);
            PurchaseHeader.TESTFIELD("Order Date");
            PurchaseHeader."Calculate Tax Structure" := TRUE;
            PurchaseHeader.MODIFY;
        END;

        PurchLine.CalculateStructures(PurchaseHeader);
        PurchLine.AdjustStructureAmounts(PurchaseHeader);
        PurchLine.UpdatePurchLines(PurchaseHeader);
        IF Is_Release = TRUE THEN
            Releasing(PurchaseHeader);
    end;

    [LineStart(5366)]
    procedure Releasing(PurchaseHeader: Record "Purchase Header");
    var
        ReleasePurchDoc: Codeunit "Release Purchase Document";
        vendorRec: Record Vendor;
    begin
        // Added by Rakesh to restrict items with unit cost zero on 15-Oct-14
        PurchLine.RESET;
        PurchLine.SETRANGE(PurchLine."Document No.", PurchaseHeader."No.");
        PurchLine.SETRANGE(PurchLine.Type, PurchLine.Type::Item);
        IF PurchLine.FINDSET THEN
            REPEAT
                IF (PurchLine."Unit Cost (LCY)" = 0) AND (PurchLine.Sample = FALSE) THEN     //Added by Pranavi on 07-08-2015 for if item is sample then allow without unit cost
                    ERROR('Enter the unit cost for ' + PurchLine."No.");

                IF PurchLine."Gen. Prod. Posting Group" = '' THEN      //added by Pranavi on 07-07-2015 to restrict items without Gen.Prod.posting grp
                    ERROR('Please Enter General Prod. Posting Group for ' + PurchLine."No.");
                item.RESET;                                   //Added by Pranavi to restrict items with PO Blocked is true on 27-07-2015
                item.SETFILTER(item."No.", PurchLine."No.");
                IF item.FINDFIRST THEN BEGIN
                    IF item."PO Blocked" = TRUE THEN
                        ERROR('Purch Order Cannot be released beacause of Item: ' + item."No." + ' is blocked for PO!');
                END;                                      //End by Pranavi
            UNTIL PurchLine.NEXT = 0;

        // end by Rakesh

        vendorRec.RESET;
        vendorRec.SETFILTER(vendorRec."No.", PurchaseHeader."Buy-from Vendor No.");
        vendorRec.SETFILTER(vendorRec."Way bill Required", '%1', TRUE);
        IF vendorRec.FINDFIRST THEN BEGIN
            IF PurchaseHeader."Way bill" = '' THEN
                ERROR('Please enter way bill No.');
        END;



        "G\L".GET;
        IF "G\L"."Active ERP-CF Connection" THEN BEGIN
            PurchaseHeader.TESTFIELD(Status, Status::Open);
            PurchaseHeader.TESTFIELD(Structure);
            PurchaseHeader.TESTFIELD("Payment Terms Code");
            IF "Payment Terms".GET(PurchaseHeader."Payment Terms Code") THEN BEGIN
                IF NOT "Payment Terms"."Update In Cashflow" THEN
                    ERROR('PAYMENT TERMS CODE MUST BE UPDATED IN CASH FLOW');
            END;
            IF (NOT PurchaseHeader."Calculate Tax Structure") AND (PurchaseHeader.Structure <> '') THEN
                ERROR('PLEASE CALCULATE THE TAX STRUCTURE');
        END
        //Added by sundar for resolving records missing in Cashflow
        ELSE BEGIN
            IF UPPERCASE(USERID) IN ['EFFTRONICS\ANILKUMAR', 'EFFTRONICS\PRANAVI'] THEN BEGIN
                IF NOT CONFIRM(Text001, FALSE, PurchaseHeader."No.") THEN
                    EXIT;
            END
            ELSE
                ERROR('Cash Flow connection is not active Contact ERP Team');
        END;
        //Added by sundar for resolving records missing in Cashflow
        IF (PurchaseHeader."Order Date" = 0D) OR (PurchaseHeader."Order Date" > "G\L"."Allow Posting To") THEN
            MESSAGE('PLEASE ENTER THE ORDER DATE ');

        IF (PurchaseHeader.Structure = '') AND (NOT PurchaseHeader."Inclusive of All Taxes") AND (PurchaseHeader."Order Date" > 121709D) THEN //Rev01
            ERROR('PLEASE ENTER THE TAX STRUCTRE & CALCULATE THE TAX STRUCTURE');

        IF NOT ((PurchaseHeader."Location Code" = 'R&D STR') OR (PurchaseHeader."Location Code" = 'CS STR') OR (PurchaseHeader."Location Code" = 'STR') OR (PurchaseHeader."Location Code" = 'SITE')) THEN
            ERROR('Location Code Must be In R&D STR,CS STR,STR,SITE');//sundar

        IF PurchaseHeader."Location Code" = 'R&D STR' THEN BEGIN
            IF (COPYSTR(PurchaseHeader."Shortcut Dimension 1 Code", 1, 2) <> 'RD') THEN
                ERROR('Please Pick R&D Dimension Code')
        END;
        IF PurchaseHeader."Location Code" = 'CS STR' THEN BEGIN
            IF (COPYSTR(PurchaseHeader."Shortcut Dimension 1 Code", 1, 3) <> 'CUS') THEN
                ERROR('Please Pick CS Dimension Code')
        END;
        IF PurchaseHeader."Location Code" = 'STR' THEN BEGIN
            IF (COPYSTR(PurchaseHeader."Shortcut Dimension 1 Code", 1, 3) <> 'PRD') THEN
                ERROR('Please Pick PRD Dimension Code')
        END;
        PurchLine.SETRANGE(PurchLine."Document No.", PurchaseHeader."No.");
        PurchLine.SETFILTER(PurchLine.Quantity, '>%1', 0);
        IF PurchLine.FINDSET THEN
            REPEAT
                IF PurchLine."Buy-from Vendor No." <> PurchaseHeader."Buy-from Vendor No." THEN
                    ERROR('VENDOR MUST BE SAME IN PURCHASE LINES & HEADER');
                IF (PurchLine.Type = PurchLine.Type::Item) OR (PurchLine.Type = PurchLine.Type::"G/L Account") THEN BEGIN
                    IF (PurchLine.Type = PurchLine.Type::Item) AND (PurchLine.Make = '') THEN
                        ERROR('Enter Make for Item ' + PurchLine.Description);
                    IF ((PurchaseHeader."Sale Order No" = '') AND (PurchLine.Type = PurchLine.Type::Item)) AND (PurchaseHeader."Order Date" > 060109D) THEN;
                    // PurchLine.TESTFIELD(PurchLine."Expected Receipt Date");

                    IF PurchLine."Gen. Prod. Posting Group" = '' THEN
                        ERROR(' THERE IS NO "Gen. Prod. Posting Group" FOR ' + PurchLine.Description);
                    IF (PurchLine."Location Code" = 'SITE') AND (PurchaseHeader."Order Date" > 081109D) THEN BEGIN
                        IF PurchLine."Shortcut Dimension 2 Code" = '' THEN
                            ERROR('Please Enter the Site Information');
                        /* IF (PurchaseHeader."Sale Order No"='') THEN
                            //  ERROR('Please Enter the Sale Order Information');
                          END
                          ELSE  IF (PurchLine."Location Code"='SITE') AND (PurchaseHeader."Order Date"<110809D)   THEN
                          BEGIN */
                        /* IF (PurchaseHeader."Sale Order No"='') THEN
                            ERROR('Please Enter the Sale Order Information');*///anil comented for closed sale orders details
                    END;


                    IF (PurchLine."Direct Unit Cost" = 0) AND NOT (PurchLine.Sample) THEN
                        ERROR('THERE IS NO COST FOR THE ITEM  ' + PurchLine.Description);
                    "Excepted Rcpt.Date Tracking".RESET;
                    "Excepted Rcpt.Date Tracking".SETRANGE("Excepted Rcpt.Date Tracking"."Document No.", PurchLine."Document No.");
                    "Excepted Rcpt.Date Tracking".SETRANGE("Excepted Rcpt.Date Tracking"."Document Line No.", PurchLine."Line No.");
                    /*  IF NOT ("Excepted Rcpt.Date Tracking".FINDFIRST) THEN
                      BEGIN
                        IF(PurchLine."Expected Receipt Date"<>PurchLine."Deviated Receipt Date")  AND ("Order Date">010609D) THEN
                        ERROR('Expected Receipt Date is not equal to Deviated Receipt Date for '+PurchLine."No.");
                      //MESSAGE('');
                      END;   */
                    IF (PurchLine.Type <> PurchLine.Type::"G/L Account") THEN
                        PurchLine.TESTFIELD(PurchLine."QC Enabled");
                    IF PurchaseHeader."Location Code" <> PurchLine."Location Code" THEN
                        ERROR('location code not matching in both line and header');
                END;
            UNTIL PurchLine.NEXT = 0;
        //comment by anil
        // MAIL CODE FOR ORDERING THE R&D INDENTS
        /*
        IF (USERID<>'EFFTRONICS\CHOWDARY') AND (USERID<>'EFFTRONICS\BRAHMAIAH') AND (USERID<>'EFFTRONICS\ANILKUMAR')AND (USERID<>'SUPER') AND (USERID<>'EFFTRONICS\PRANAVI')  THEN
        ERROR('You have No Rights')
        ELSE
        BEGIN
        
        IF (PurchaseHeader."Location Code"='R&D STR') AND (PurchaseHeader.Status=Status::Open) THEN
        BEGIN
        j:=0;
          Prev_Indent:='';
          PurchLine.RESET;
          PurchLine.SETRANGE(PurchLine."Document No.",PurchaseHeader."No.");
          PurchLine.SETCURRENTKEY(PurchLine."Indent No.");
          PurchLine.SETRANGE(PurchLine."Location Code",'R&D STR');
          IF PurchLine.FINDSET THEN
          REPEAT
        
          IF PurchLine."Indent No."<>'' THEN
          BEGIN
           IF (Prev_Indent='') OR (Prev_Indent<>PurchLine."Indent No.") THEN
           BEGIN
              IF j<=0 THEN
              j:=1
              ELSE
              j:=j;
              Body:='';
              Mail_From:='';
              Mail_To:='';
              Subject:='';
              attachment:='';
              Prev_Indent:=PurchLine."Indent No.";
              PL.RESET;
              PL.SETRANGE(PL."Document No.",PurchLine."Document No.");
              PL.SETRANGE(PL."Indent No.",Prev_Indent);
              IF PL.FINDFIRST THEN
              BEGIN
              REPORT.RUN(50157,FALSE,FALSE,PL);
              attachment:='\\erpserver\ErpAttachments\ErpAttachments1\p_int_details'+FORMAT(j)+'.html';
              REPORT.SAVEASHTML(50157,attachment,FALSE,PL);
              END;
              INDENT_HEADER.RESET;
              INDENT_HEADER.SETRANGE(INDENT_HEADER."No.",Prev_Indent);
              INDENT_HEADER.SETRANGE(INDENT_HEADER."Delivery Location",'R&D STR');
               IF INDENT_HEADER.FINDFIRST THEN
                BEGIN
                 dateofit:=DT2DATE(INDENT_HEADER."Release Date Time");
                 noofdays:=FORMAT(TODAY-dateofit);
                 USER.RESET;
                 USER.SETRANGE(USER."User ID",USERID);
                 IF USER.FINDFIRST THEN
                  Mail_From:=USER.MailID;
                 USER.RESET;
                 USER.SETRANGE(USER."User ID",INDENT_HEADER."Person Code");
                 IF USER.FINDFIRST THEN
                   Mail_To:=USER.MailID;
                 Subject:='YOUR INDENT ('+Prev_Indent +' ) FOR "'+INDENT_HEADER."Production Order Description"+'" HAS BEEN ORDERED ';
        //         Body+=FORMAT(NEW_LINE);
                 Body+='****testing  Auto Mail Generated From ERP  ****';
        //         Mail_From:='sreenu@efftronics.com';
        //         Mail_To:='sreenu@efftronics.com';
                 IF((Mail_From<>'') AND (Mail_To<>'')) THEN
                 BEGIN
                   SMTP_MAIL.CreateMessage('PURCHASE ORDER',Mail_From,Mail_To,Subject,Body,FALSE);
                   SMTP_MAIL.AddAttachment(attachment);
                 END;
        //            SLEEP(2000);
                j:=j+1;
                END;
            END;
           END;
          UNTIL PurchLine.NEXT=0;
        END;
        END;
        */
        IF NOT (UPPERCASE(USERID) IN ['EFFTRONICS\CHOWDARY', 'EFFTRONICS\BRAHMAIAH', 'EFFTRONICS\ANILKUMAR', 'EFFTRONICS\RENUKACH', 'EFFTRONICS\SPURTHI', 'EFFTRONICS\ANVESH']) THEN
            ERROR('You have No Rights to release. Contact Purchase Dept Manager')
        ELSE
            ReleasePurchDoc.PerformManualRelease(PurchaseHeader);

        "Packing Value" := 0;
        //PurchLine.CALCFIELDS(PurchLine."Document Date");
        PurchLine.RESET;
        PurchLine.SETRANGE(PurchLine."Document No.", PurchaseHeader."No.");
        PurchLine.SETFILTER(PurchLine."No.", '<>%1', '');
        IF PurchLine.FINDSET THEN
            REPEAT
                PurchLine.CALCFIELDS(PurchLine."Document Date");

                "G\L".GET;
                IF "G\L"."Active ERP-CF Connection" AND (PurchaseHeader."Order Date" >= 020110D) THEN //
                BEGIN

                    "Packing Value" := 0;
                    Frieght_Value := 0;
                    Insurance_Value := 0;
                    Additional_Duty := 0;
                    Service_Amount := 0;
                    Line_Amount := 0;
                    Unit_Cost := 0;
                    StructureOrderLineDetails.RESET;
                    StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails.Type, StructureOrderLineDetails.Type::Purchase);
                    StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails."Document No.", PurchLine."Document No.");
                    StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails."Line No.", PurchLine."Line No.");
                    StructureOrderLineDetails.SETRANGE(StructureOrderLineDetails.Type, StructureOrderLineDetails.Type::Purchase);
                    IF StructureOrderLineDetails.FINDSET THEN
                        REPEAT
                            IF ((StructureOrderLineDetails."Tax/Charge Group" = 'PACKING') OR
                               (StructureOrderLineDetails."Tax/Charge Group" = 'FORWARDING')) THEN BEGIN

                                "Packing Value" += StructureOrderLineDetails."Amount (LCY)";
                            END ELSE
                                IF StructureOrderLineDetails."Tax/Charge Group" = 'FREIGHT' THEN BEGIN
                                    Frieght_Value += StructureOrderLineDetails."Amount (LCY)";
                                END ELSE
                                    IF StructureOrderLineDetails."Tax/Charge Group" = 'CUSTOMS DU' THEN BEGIN
                                        Frieght_Value += StructureOrderLineDetails."Amount (LCY)";
                                    END ELSE

                                        IF StructureOrderLineDetails."Tax/Charge Group" = 'INSURANCE' THEN BEGIN
                                            Insurance_Value += StructureOrderLineDetails."Amount (LCY)";
                                        END ELSE
                                            IF StructureOrderLineDetails."Tax/Charge Group" = 'ADD.DUTY' THEN
                                                Additional_Duty += StructureOrderLineDetails."Amount (LCY)"
                                            ELSE
                                                IF StructureOrderLineDetails."Tax/Charge Type" = StructureOrderLineDetails."Tax/Charge Type"::"Service Tax" THEN
                                                    Service_Amount += StructureOrderLineDetails."Amount (LCY)";

                        UNTIL StructureOrderLineDetails.NEXT = 0;
                    // END;
                    IF PurchLine."Currency Code" = '' THEN BEGIN
                        Unit_Cost := PurchLine."Direct Unit Cost";
                        Line_Amount := PurchLine."Line Amount";
                    END ELSE BEGIN
                        Unit_Cost := PurchLine."Direct Unit Cost" / PurchaseHeader."Currency Factor";
                        Line_Amount := (PurchLine.Quantity * PurchLine."Direct Unit Cost") / PurchaseHeader."Currency Factor";

                    END;
                    IF PurchLine."Line Discount Amount" > 0 THEN
                        Additional_Duty -= PurchLine."Line Discount Amount";
                    IF (PurchLine."Frieght Charges" > 0) THEN BEGIN
                        IF PurchLine."Currency Code" = '' THEN
                            Frieght_Value := PurchLine."Frieght Charges"
                        ELSE
                            Frieght_Value := PurchLine."Frieght Charges" / PurchaseHeader."Currency Factor";
                    END;
                    IF (PurchLine."Tax Area Code" = 'PURH VAT') THEN
                        VAT_AMOUNT := PurchLine."Tax Amount"
                    ELSE
                        CST_AMOUNT := PurchLine."Tax Amount";
                    IF PurchLine."Location Code" = 'CS STR' THEN
                        Dept := 'CS'
                    ELSE
                        Dept := 'NORMAL';

                    IF (PurchLine.Sample = FALSE) AND (UPPERCASE(USERID) <> 'EFFTRONICS\RAJANI') THEN
                        CashFlowConnection.ExecInOracle('insert into Purchase_line' +
                                                        '(PURCHASE_ID,ORDERNO,ITEMNO,VENDORID,UNIT_COST,UNITS_REQ,DEVIATED_DATE,ORDER_RELEASE_DATE,' +
                                                        ' VAT,EXCISE,CST,PAYMENT_TERMS_CODE,ORDER_VALUE,PACKING_COST,ORDER_LINE_NO,SERVICE_AMOUNT,' +
                                                        'INSURANCE_VALUE,FRIEGHT_CHARGES,ADD_DUTY,LOCATION_CODE,DEPT_WISE,ACTINACT)' +
                                                        'values (seq_Purchase_ID.nextval,''' + PurchLine."Document No." + ''', ''' + PurchLine."No." + ''',''' +
                                                        PurchaseHeader."Buy-from Vendor No." + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND(Unit_Cost, 0.001))) + ''',''' +
                                                        CommaRemoval(FORMAT(PurchLine.Quantity)) + ''',''' +
                                                        FORMAT(PurchLine."Deviated Receipt Date", 0, '<Day>-<Month Text,3>-<Year4>') + ''',''' +
                                                        FORMAT(DT2DATE(PurchaseHeader."Release Date Time"), 0, '<Day>-<Month Text,3>-<Year4>') + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND(VAT_AMOUNT, 0.01))) + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND(PurchLine."Excise Amount", 0.01))) + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND(CST_AMOUNT, 0.01))) + ''',''' +
                                                        FORMAT(PurchaseHeader."Payment Terms Code") + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND(Line_Amount, 0.001))) + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND("Packing Value", 0.001))) + ''',''' +
                                                        FORMAT(PurchLine."Line No.") + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND(Service_Amount, 0.01))) + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND(Insurance_Value, 0.01))) + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND(Frieght_Value, 0.01))) + ''',''' +
                                                        CommaRemoval(FORMAT(ROUND(Additional_Duty, 0.01))) + ''',''' +
                                                        PurchLine."Location Code" + ''',''' +
                                                        Dept + ''',1)');
                    //  MESSAGE(FORMAT(ROUND(Line_Amount,0.001)));
                END;
            UNTIL PurchLine.NEXT = 0;

        Mail_From := 'ERP@efftronics.com';

        Mail_To := 'erp@efftronics.com';
        SMTP_MAIL.CreateMessage('EFF', Mail_From, Mail_To, 'PO ISSUE', 'PO ISSUE' + "USER ID" + Rec."No.", TRUE);
        SMTP_MAIL.Send;

        Mails;

    end;

    [LineStart(5694)]
    local procedure UpdateInfoPanel();
    var
        DifferBuyFromPayTo: Boolean;
    begin
        //EFFUPG DocExist function doesn't exist as globally in NAV 2016 Base
        /*
        DifferBuyFromPayTo := "Buy-from Vendor No." <> "Pay-to Vendor No.";
        PurchHistoryBtnVisible := DifferBuyFromPayTo;
        PurchHistoryBtn1Visible := PurchInfoPaneMgmt.DocExist(Rec,"Buy-from Vendor No.");
        IF DifferBuyFromPayTo THEN
          PurchHistoryBtnVisible := PurchInfoPaneMgmt.DocExist(Rec,"Pay-to Vendor No.")
        */
        //EFFUPG

    end;

    [LineStart(5705)]
    local procedure checkminimumordervalue();
    begin
        //added by Vishnu Priya for Vendor minimum order value checking on 18-12-2018

        VENDOR.RESET;
        VENDOR.SETCURRENTKEY("No.");
        VENDOR.SETFILTER("No.", Rec."Buy-from Vendor No.");
        IF VENDOR.FINDFIRST THEN BEGIN
            PL.RESET;
            PL.SETFILTER("Document No.", Rec."No.");
            ORDER_VAL := 0;
            IF PL.FINDSET THEN
                REPEAT
                BEGIN
                    ORDER_VAL := ORDER_VAL + PL.Amount;
                END
                UNTIL PL.NEXT = 0;
            IF VENDOR."Minimum Order Value" > ORDER_VAL THEN
                ERROR('Purchase Order value %2 < Vendor Minimum Order Value is %1 So You can''' + 't Raise the PO', VENDOR."Minimum Order Value", ORDER_VAL);
        END;
    end;

    [LineStart(5726)]
    procedure ten_percent_item_Cost_high_chk() CNTNUE: Boolean;
    begin
        LoopVar := 1;
        itm_loop := 1;
        PL.RESET;
        PL.SETRANGE("Document No.", Rec."No.");
        PL.SETFILTER("Outstanding Quantity", '>%1', 0);
        PL.SETRANGE(Type, PL.Type::Item);
        IF PL.FINDSET THEN
            REPEAT
            BEGIN
                Pur_line.RESET;
                Pur_line.SETFILTER("Document No.", '<%1', PL."Document No.");
                Pur_line.SETRANGE("No.", PL."No.");
                Pur_line.SETRANGE(Type, PL.Type::Item);
                Pur_line.SETFILTER("Outstanding Quantity", '>%1', 0);
                IF Pur_line.FINDLAST THEN
                    REPEAT
                    BEGIN
                        ten_percent_cost := (Pur_line."Direct Unit Cost" * 0.1);
                        ten_percent_cost := ten_percent_cost + Pur_line."Direct Unit Cost";
                        IF PL."Direct Unit Cost" > ten_percent_cost THEN BEGIN
                            items_list_cost[LoopVar] [1] := Pur_line."Document No.";
                            items_list_cost[LoopVar] [2] := FORMAT(Pur_line."No.");
                            items_list_cost[LoopVar] [3] := FORMAT(Pur_line."Direct Unit Cost");
                            LoopVar := LoopVar + 1;
                        END

                        ELSE
                            EXIT(TRUE);
                    END;

                    UNTIL Pur_line.NEXT = 0
                ELSE
                    EXIT(TRUE);


            END;
            UNTIL PL.NEXT = 0
        ELSE
            EXIT(TRUE);
        options_itm_cost := '';
        IF (ARRAYLEN(items_list_cost) > 2) THEN BEGIN
            FOR itm_loop := 1 TO LoopVar - 1 DO BEGIN
                options_itm_cost := options_itm_cost + items_list_cost[itm_loop] [2] + ':' + items_list_cost[itm_loop] [1] + ',';
            END;
        END;
        IF (ARRAYLEN(items_list_cost) > 2) THEN BEGIN

            IF ((DIALOG.STRMENU(options_itm_cost, LoopVar + 5, 'This order having 10% more unit cost than the below orders, Click OK Continue')) = 1) THEN
                EXIT(TRUE)
            ELSE
                EXIT(FALSE);
        END;
        EXIT(TRUE);
    end;

    [LineStart(5785)]
    local procedure IndentExistedOrnot();
    begin
        //ADDED BY VISHNU PRIYA ON 06-07-2019
        IF //((Rec."First Release By" = '') AND   // commented by vishnu on 04-01-2020
          NOT (USERID IN ['EFFTRONICS\SUJANI']) THEN  //,'EFFTRONICS\VISHNUPRIYA'
        BEGIN
            PL.RESET;
            PL.SETRANGE("Document No.", Rec."No.");
            PL.SETFILTER(PL.Type, '<>%1', PL.Type::" ");  //,PL.Type::"Fixed Asset"
            IF PL.FINDSET THEN
                REPEAT
                    IF (PL."Indent No." = '') AND (PL.Type = PL.Type::Item) AND (Rec."Order Date" < 111220D) THEN
                        ERROR('There is No Indent to Line Number: ' + FORMAT(PL."Line No."))
                    ELSE
                        IF (PL."Indent No." = '') AND (Rec."Order Date" >= 111220D) THEN
                            ERROR('There is No Indent to Line Number: ' + FORMAT(PL."Line No."));
                UNTIL PL.NEXT = 0;
        END;
    end;

    [LineStart(5802)]
    local procedure UpdationtoIndentLines();
    begin
        //ADDED BY VISHNU PRIYA ON 06-07-2019
        indentline.RESET;
        indentline.SETCURRENTKEY("Document No.", "Line No.");
        PL.RESET;
        PL.SETFILTER("Document No.", Rec."No.");
        PL.SETFILTER("Indent No.", '<>%1', '');
        IF PL.FINDSET THEN
            REPEAT
                indentline.SETFILTER("Base Indent Number", PL."Indent No.");
                indentline.SETRANGE("Base Indent Line Number", PL."Indent Line No.");
                IF indentline.FINDFIRST THEN BEGIN
                    indentline."Purchase Order Number" := PL."Document No.";
                    indentline."Purchase Order Line Number" := PL."Line No.";
                    indentline.MODIFY;
                END;
            UNTIL PL.NEXT = 0;
    end;

    [LineStart(5820)]
    procedure Vendor_approved_or_Not();
    begin
        PurchHead.RESET;
        PurchHead.SETFILTER("Buy-from Vendor No.", Rec."Buy-from Vendor No.");
        PurchHead.SETRANGE("Document Type", PurchHead."Document Type"::Order);
        IF NOT PurchHead.FINDFIRST THEN BEGIN
            IF Vndr.GET("Buy-from Vendor No.") THEN BEGIN
                IF Vndr."Maanager Approved" = FALSE THEN
                    ERROR('Ensure the vendor to be Approved by the Manager.');
            END;
        END;
    end;

    [LineStart(5833)]
    procedure Location_Mismatch_Not();
    begin
        // Added by Vishnu Priya on 03-12-2020
        PurchLine.RESET;
        PurchLine.SETFILTER("Document No.", Rec."No.");
        PurchLine.SETFILTER(Quantity, '>%1', 0);
        IF PurchLine.FINDSET THEN
            REPEAT
                IF Rec."Location Code" <> PurchLine."Location Code" THEN
                    ERROR('Select the same Location code in both Header and Line. In Line Number %1 is  different with Header Location', FORMAT(PurchLine."Line No."));
            UNTIL PurchLine.NEXT = 0;
        // Added by Vishnu Priya on 03-12-2020
    end;

    //Unsupported feature: InsertAfter on "Documentation". Please convert manually.


    //Unsupported feature: PropertyChange. Please convert manually.


    //Unsupported feature: PropertyChange. Please convert manually.


    //Unsupported feature: PropertyChange. Please convert manually.


    //Unsupported feature: PropertyChange. Please convert manually.


    //Unsupported feature: PropertyChange. Please convert manually.

}

